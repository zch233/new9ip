import{a2 as a,d as s,s as e,u as t,a as n,v as o,r,$ as i,e as p,p as d,f as c,g as l,h as u,i as f,j as m,m as I,n as U}from"./index.e0d03852.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.9a0c2655.js";import"./raf.86450f37.js";import"./CloseOutlined.a544391c.js";import"./toString.7ea59509.js";import"./identity.16017226.js";import"./debounce.b5f9dfa3.js";import"./omit.ba35c8f5.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.189064d6.js";import"./index.718bdbc6.js";import"./index.bcf81b34.js";import"./index.1b896c71.js";import"./_baseProperty.d6ff4684.js";import{s as h,a as v}from"./UIFormItem.cb9fbe8d.js";import{s as g,u as b}from"./index.164c3699.js";import"./UICountdown.98708d11.js";import"./index.95770fae.js";import"./Col.725675a2.js";import"./dict.a53fee1f.js";import{s as j}from"./UIInput.c2bea5d3.js";import{s as _}from"./UIButton.5e81bc30.js";import{g as x}from"./index.3c366fab.js";import{a as y,s as B}from"./UITabPane.8760cfde.js";import{a as w}from"./signIn.a422f366.js";var k=s({name:"AuthSignUp",components:{UITabs:y,UITabPane:B,UIInput:j,Icon:e,UIButton:_,UIForm:h,UIFormItem:v,Captcha:g},setup(){const s=t(),e=n(),d=o(),c=r(!1),l=i({phone:"",password:"",captcha:"",referrer:x(s.query.code)||""}),u=i({phone:[{required:!0,message:""},{len:11,message:""}],password:[{required:!0,message:""}],captcha:[{required:!0,message:""},{len:6,message:""}]}),{validate:f,validateInfos:m}=b(l,u);return{route:s,signUpInfo:l,validateInfos:m,submitLoading:c,signUp:()=>{f().then((async()=>{var t;c.value=!0,await(t=l,a({url:"/pub/api/v1/authc/regByMobile",method:"post",data:t})).finally((()=>c.value=!1)),p.success("注册成功!");const n=p.loading("正在为您自动登录...");c.value=!0,await w(l);const o=await d.dispatch("setUser").finally((()=>n()));await e.push(x(s.query.redirect)||"/"),p.success(`欢迎回来，${o.nickname}`)}),(()=>p.error("表单输入有误")))}}}});const C=I("data-v-35062749");d("data-v-35062749");const q={class:"signUp"},P=m("b",null,"新用户注册",-1),F={class:"shrinkBar accountBar"},L={class:"shrinkBar captchaBar"},S={class:"shrinkBar passwordBar"},T={class:"referrerBar"},A={class:"buttonBar"},O=U("注册"),$={class:"infoBar"},M=U("点击注册代表已同意 "),R=U("《用户服务协议》"),z=U("返回登录");c();const D=C(((a,s,e,t,n,o)=>{const r=l("Icon"),i=l("UIInput"),p=l("UIFormItem"),d=l("Captcha"),c=l("UITabPane"),I=l("UITabs"),U=l("UIButton"),h=l("RouterLink"),v=l("UIForm");return u(),f("div",q,[m(v,{layout:"vertical"},{default:C((()=>[m(I,{animated:!1},{default:C((()=>[m(c,{key:"signUp"},{tab:C((()=>[P])),default:C((()=>[m(p,a.validateInfos.phone,{default:C((()=>[m("div",F,[m(i,{value:a.signUpInfo.phone,"onUpdate:value":s[1]||(s[1]=s=>a.signUpInfo.phone=s),placeholder:"请输入手机号",maxlength:11},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputPhone"})])),_:1},8,["value"])])])),_:1},16),m(p,a.validateInfos.captcha,{default:C((()=>[m("div",L,[m(i,{value:a.signUpInfo.captcha,"onUpdate:value":s[2]||(s[2]=s=>a.signUpInfo.captcha=s),class:"captcha",placeholder:"验证码",maxlength:6},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputCaptcha"})])),addonAfter:C((()=>[m(d,{info:a.signUpInfo},null,8,["info"])])),_:1},8,["value"])])])),_:1},16),m(p,a.validateInfos.password,{default:C((()=>[m("div",S,[m(i,{value:a.signUpInfo.password,"onUpdate:value":s[3]||(s[3]=s=>a.signUpInfo.password=s),type:"password",placeholder:"请输入密码"},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputPassword"})])),_:1},8,["value"])])])),_:1},16),m(p,a.validateInfos.referrer,{default:C((()=>[m("div",T,[m(i,{readonly:!!a.route.query.code,value:a.signUpInfo.referrer,"onUpdate:value":s[4]||(s[4]=s=>a.signUpInfo.referrer=s),placeholder:"推荐人手机号或者工号（选填）",maxlength:11},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputAgent"})])),_:1},8,["readonly","value"])])])),_:1},16)])),_:1})])),_:1}),m("div",A,[m(U,{loading:a.submitLoading,type:"primary",block:"","customer-class":"mainButton",onClick:a.signUp},{default:C((()=>[O])),_:1},8,["loading","onClick"])]),m("div",$,[m("p",null,[M,m(h,{class:"toSignUp",to:"/others/helper?aq=1-2"},{default:C((()=>[R])),_:1})]),m(h,{class:"darkLink",to:"/auth/sign_in"},{default:C((()=>[z])),_:1})])])),_:1})])}));k.render=D,k.__scopeId="data-v-35062749";export default k;
