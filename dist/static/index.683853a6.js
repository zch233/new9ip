let e=document.createElement("style");e.innerHTML=".orderItemCountDown .ant-statistic-content{font-size:14px}.orderTimeRangeSelect[data-v-7449d57e]{background-color:#fff;font-size:12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.orderTimeRangeSelect li[data-v-7449d57e]{padding:8px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer}.orderTimeRangeSelect li.active[data-v-7449d57e],.orderTimeRangeSelect li[data-v-7449d57e]:hover{color:#333}.orderTimeRangeSelect li[data-v-7449d57e]:last-child{border-bottom:none}.listWrapper[data-v-7449d57e]{padding:10px 20px}.listWrapper .listTitle[data-v-7449d57e]{background-color:#e8e8e8;display:flex;text-align:center;color:#666;font-size:12px;padding:0 20px;border:1px solid #e8e8e8;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.listWrapper .listTitle-item[data-v-7449d57e]{padding:16px 0;cursor:default}.listWrapper .listTitle-item.colTime[data-v-7449d57e]{cursor:pointer}.listWrapper .colTime[data-v-7449d57e]{flex:.9}.listWrapper .colInfo[data-v-7449d57e]{flex:2;padding-right:70px;padding-left:20px}.listWrapper .colPrice[data-v-7449d57e],.listWrapper .colStatus[data-v-7449d57e]{flex:2}.listWrapper .colOptions[data-v-7449d57e]{flex:1.4}.listWrapper .listContent-item[data-v-7449d57e]{margin-top:10px}.listWrapper .listContent-item-top[data-v-7449d57e]{color:#666;font-size:12px;background-color:#f7f7f7;padding:8px 30px;border:1px solid #dedede;border-bottom:none}.listWrapper .listContent-item-top>[data-v-7449d57e]{margin-right:2em}.listWrapper .listContent-item-top .time[data-v-7449d57e]{color:#333}.listWrapper .listContent-item-content[data-v-7449d57e]{display:flex;align-items:center;padding:20px;color:#666;border:1px solid #dedede;border-top:none}.listWrapper .listContent-item-content-image[data-v-7449d57e]{width:90px}.listWrapper .listContent-item-content-image img[data-v-7449d57e]{width:100%}.listWrapper .listContent-item-content-info b[data-v-7449d57e]{display:inline-block;height:2.8em}.listWrapper .listContent-item-content-info p[data-v-7449d57e]{margin:4px 0 0;color:#999}.listWrapper .listContent-item-content-price>p[data-v-7449d57e]{margin-bottom:2px}.listWrapper .listContent-item-content-price label[data-v-7449d57e]{color:#999;font-size:12px}.listWrapper .listContent-item-content-price .totalPrice[data-v-7449d57e]{color:#ff5858}.listWrapper .listContent-item-content-price .totalPrice b[data-v-7449d57e]{font-size:24px}.listWrapper .listContent-item-content-options[data-v-7449d57e],.listWrapper .listContent-item-content-status[data-v-7449d57e]{text-align:center}.listWrapper .listContent-item-content-options>[data-v-7449d57e]{margin:2px 0}.listWrapper .paginationBar[data-v-7449d57e]{padding:40px 0;text-align:center}",document.head.appendChild(e);import{a2 as t,d as a,s as o,u as n,a as i,r,$ as s,ay as l,o as d,e as p,p as c,f as u,g as m,h as g,i as f,j as v,F as y,k as T,n as b,t as h,m as C,l as x}from"./index.e0d03852.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.9a0c2655.js";import"./raf.86450f37.js";import{s as k}from"./UIPagination.80faac09.js";import"./CloseOutlined.a544391c.js";import"./toString.7ea59509.js";import"./identity.16017226.js";import"./debounce.b5f9dfa3.js";import"./omit.ba35c8f5.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.189064d6.js";import"./CheckOutlined.bc6362b3.js";import"./index.718bdbc6.js";import"./index.bcf81b34.js";import{M as I}from"./index.1b896c71.js";import{s as S,a as R}from"./index.969247a1.js";import"./_baseProperty.d6ff4684.js";import{s as O}from"./UICountdown.98708d11.js";import"./index.95770fae.js";import{s as P}from"./UISpin.a57088ab.js";import{s as w}from"./UIInputSearch.511cf753.js";import{g as j}from"./dict.a53fee1f.js";import{s as U}from"./UIEmpty.1c481d05.js";import{s as W}from"./index.58c3c00a.js";import{s as z}from"./UIButton.5e81bc30.js";import"./UIModal.ff47e4f6.js";import{b as E,o as N}from"./index.3c366fab.js";import{s as _}from"./index.5035bd48.js";import{s as D,a as A}from"./UITabPane.8760cfde.js";import{o as q}from"./orderConfirm.15f311d2.js";const M=[{title:"全部",key:"all"},{title:"近三个月订单",key:"threeMonth"},{title:"近一个月订单",key:"oneMonth"},{title:"最近七天订单",key:"week"}],$={all:[],threeMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]})(),oneMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]})(),week:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]})()},B=e=>JSON.parse(JSON.stringify({dateRange:e,startDate:$[e][0]&&E($[e][0]),endDate:$[e][1]&&E($[e][1])}));var L=a({name:"OrderTabPane",components:{UITabPane:D,UIButton:z,UIDropdown:S,Icon:o,UIPagination:k,UIEmpty:U,UISpin:P,UICountdown:O,PayRoutesPopover:R,PatentImage:W},props:{status:Number},setup({status:e}){const a=n(),o=i(),c=r(!1),u=r([]),m=r(!1),g=r(null),f=r(a.query),v=r(a.query.dateRange?M.find((e=>e.key===a.query.dateRange)):M[1]),y=s({total:0,current:1,size:10,pageSizeOptions:["10","30","50","100"],showSizeChange:(e,t)=>{window.scrollTo(0,0),o.push({path:"/user/preorder",query:{...f.value,size:t,no:1}})},change:e=>{window.scrollTo(0,0),o.push({path:"/user/preorder",query:{...f.value,no:e}})}}),T=async a=>{if(c.value||(f.value.status||"999")!==e?.toString())return;c.value=!0;const{data:o}=await(n={size:y.size,...B(v.value.key),...a,status:999===e?void 0:e},t({url:"/api/v1/reserve",method:"get",params:n})).finally((()=>c.value=!1));var n;u.value=o?.list||[],y.total=o?.totalCount,y.current=o?.no,y.size=o?.size};l((t=>{t.query.status===(e&&e.toString())&&(f.value=t.query,T(t.query))})),d((()=>{T(f.value)}));return{loading:c,submitLoading:m,paginationOptions:y,payRoutesPopoverRef:g,preorders:u,routeQuery:f,payOrder:async({payRoute:e,tradeType:t},a)=>{m.value=!1,g.value.visible=!1;const{data:n}=await q({commodityId:a.productId,commodityType:"PATENT",payRoute:e,tradeType:t}).finally((()=>m.value=!1)),{orderNo:i,tradeNo:r}=n,s=`/order/pay/${"UMS_PAY"===e?"code":"WXPAY"===e?"wechat":"form"}?orderNo=${i}&tradeNo=${r}&type=PATENT&payRoute=${e}&tradeType=${t}`;"UMS_PAY"===e||"WXPAY"===e?await o.push(s):(_({tradeNo:r,orderNo:i,type:"PATENT"}),N(s))},PREORDER_STATUS:j,optionOrder:async e=>{I.confirm({centered:!0,class:"warningModal",title:"确定要取消该预留吗？",okType:"danger",content:"若取消预留今日将不能再次预留且积分不再返还",onOk:async()=>{const a=p.loading("正在取消预留，请稍候...",0);var o;await(o=e.id,t({url:`/api/v1/reserve/cancel/${o}`,method:"put"})).finally((()=>a())),p.success("取消成功！"),await T(f.value)}})},changeOrderStatus:e=>{u.value.find((t=>t.orderNo===e.orderNo)).status=j.CANCEL,u.value=[...u.value]},changeOrderTimeRange:e=>{v.value=M.find((t=>t.key===e)),o.push({path:"/user/preorder",query:B(e)})},orderTimeRange:M,currentOrderTimeRange:v}}});const Y=C("data-v-7449d57e");c("data-v-7449d57e");const K={class:"listWrapper"},J={class:"listTitle"},X={class:"listTitle-item colTime"},F={class:"orderTimeRangeSelect"},H=v("li",{class:"listTitle-item colInfo"},"订单详情",-1),Q=v("li",{class:"listTitle-item colPrice"},"金额",-1),V=v("li",{class:"listTitle-item colStatus"},"全部状态",-1),G=v("li",{class:"listTitle-item colOptions"},"操作",-1),Z={key:0,class:"emptyWrapper"},ee={class:"listContent"},te={class:"listContent-item-top"},ae={class:"time"},oe={key:0},ne={class:"listContent-item-content"},ie={class:"listContent-item-content-image colTime"},re={class:"listContent-item-content-info colInfo"},se={class:"listContent-item-content-price colPrice"},le=v("label",null,"价格：",-1),de=v("label",null,"VIP会员：",-1),pe={class:"listContent-item-content-status colStatus"},ce={class:"listContent-item-content-options colOptions"},ue=b("去下单"),me=b("取消预留"),ge={class:"paginationBar"};u();const fe=Y(((e,t,a,o,n,i)=>{const r=m("Icon"),s=m("UIDropdown"),l=m("UIEmpty"),d=m("PatentImage"),p=m("RouterLink"),c=(m("PayRoutesPopover"),m("UIButton")),u=m("UIPagination"),C=m("UISpin"),k=m("UITabPane");return g(),f(k,{id:"preorderTabPane"},{default:Y((()=>[v("div",K,[v("ul",J,[v("li",X,[v(s,null,{overlay:Y((()=>[v("ul",F,[(g(!0),f(y,null,T(e.orderTimeRange,(t=>(g(),f("li",{class:[e.currentOrderTimeRange.key===t.key&&"active"],key:t.key,onClick:a=>e.changeOrderTimeRange(t.key)},h(t.title),11,["onClick"])))),128))])])),default:Y((()=>[v("span",null,[b(h(e.currentOrderTimeRange.title)+" ",1),v(r,{icon:"down"})])])),_:1})]),H,Q,V,G]),0===e.preorders.length?(g(),f("div",Z,[v(l)])):(g(),f(C,{key:1,spinning:e.loading},{default:Y((()=>[v("ul",ee,[(g(!0),f(y,null,T(e.preorders,(t=>(g(),f("li",{class:"listContent-item colTime",key:t.productId},[v("div",te,[v("time",ae,h(t.createTime),1),t.orderNo?(g(),f("span",oe,"订单号："+h(t.orderNo),1)):x("",!0),v("span",null,"卖家："+h(t.sellerShopName),1)]),v("div",ne,[v("div",ie,[v(d,{category:t.productCategory},null,8,["category"])]),v("div",re,[v(p,{to:`/patent/${t.productNumber}`},{default:Y((()=>[v("b",null,h(t.productName),1)])),_:2},1032,["to"]),v("p",null,"专利号："+h(t.productNumber),1)]),v("div",se,[v("p",null,[le,b("￥"+h(t.productPrice),1)]),v("p",null,[de,b("￥"+h(t.vipPrice),1)])]),v("div",pe,h(e.PREORDER_STATUS.label[t.status]),1),v("div",ce,[t.status===e.PREORDER_STATUS.CREATED?(g(),f(y,{key:0},[v("span",null,"预定至 "+h(t.expireTime),1),x("",!0),v("div",null,[v(p,{to:{path:"/order/confirm",query:{commodityId:t.productId}}},{default:Y((()=>[v(c,{type:"primary","customer-class":"mainButton"},{default:Y((()=>[ue])),_:1})])),_:2},1032,["to"])]),v(c,{type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t)},{default:Y((()=>[me])),_:2},1032,["onClick"])],64)):x("",!0)])])])))),128))]),v("section",ge,[v(u,{size:"small",total:e.paginationOptions.total,"onUpdate:size":t[1]||(t[1]=t=>e.paginationOptions.size=t),current:e.paginationOptions.current,"onUpdate:current":t[2]||(t[2]=t=>e.paginationOptions.current=t),"page-size-options":e.paginationOptions.pageSizeOptions,"show-total":e=>`共 ${e} 条`,onChange:e.paginationOptions.change,onShowSizeChange:e.paginationOptions.showSizeChange,"show-size-changer":"","show-quick-jumper":""},null,8,["total","size","current","page-size-options","show-total","onChange","onShowSizeChange"])])])),_:1},8,["spinning"]))])])),_:1})}));L.render=fe,L.__scopeId="data-v-7449d57e";const ve=[{title:"全部",key:999},{title:"预留中",key:j.CREATED},{title:"已下单",key:j.ORDER},{title:"已付款",key:j.PAYED},{title:"已取消",key:j.CANCEL}];var ye=a({name:"Order",components:{UITabs:A,OrderTabPane:L,UIInputSearch:w},setup(){const e=n(),t=i(),a=r(e.query.status);return{PREORDER_STATUS:j,activeKey:a,orderMap:ve,changeTab:e=>{t.push({path:"/user/preorder",query:{status:999===e?void 0:e}})}}}});const Te=C("data-v-f83f3c9e");c("data-v-f83f3c9e");const be={class:"order"};u();const he=Te(((e,t,a,o,n,i)=>{const r=m("OrderTabPane"),s=m("UITabs");return g(),f("div",be,[v(s,{animated:!1,activeKey:e.activeKey,onChange:e.changeTab},{default:Te((()=>[(g(!0),f(y,null,T(e.orderMap,(e=>(g(),f(r,{key:e.key,status:e.key},{tab:Te((()=>[v("b",null,h(e.title),1)])),_:2},1032,["status"])))),128))])),_:1},8,["activeKey","onChange"])])}));ye.render=he,ye.__scopeId="data-v-f83f3c9e";export default ye;
