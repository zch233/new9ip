var e=Object.assign,t=(e,t,a)=>new Promise(((i,o)=>{var n=e=>{try{s(a.next(e))}catch(e){o(e)}},r=e=>{try{s(a.throw(e))}catch(e){o(e)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,r);s((a=a.apply(e,t)).next())}));let a=document.createElement("style");a.innerHTML=".orderItemCountDown .ant-statistic-content{font-size:14px}.orderTimeRangeSelect[data-v-1edcdd7e]{background-color:#fff;font-size:12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.orderTimeRangeSelect li[data-v-1edcdd7e]{padding:8px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer}.orderTimeRangeSelect li.active[data-v-1edcdd7e],.orderTimeRangeSelect li[data-v-1edcdd7e]:hover{color:#333}.orderTimeRangeSelect li[data-v-1edcdd7e]:last-child{border-bottom:none}.listWrapper[data-v-1edcdd7e]{padding:10px 20px}.listWrapper .listTitle[data-v-1edcdd7e]{background-color:#e8e8e8;display:-webkit-box;display:-webkit-flex;display:flex;text-align:center;color:#666;font-size:12px;padding:0 20px;border:1px solid #e8e8e8;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.listWrapper .listTitle-item[data-v-1edcdd7e]{padding:16px 0;cursor:default}.listWrapper .listTitle-item.colTime[data-v-1edcdd7e]{cursor:pointer}.listWrapper .colTime[data-v-1edcdd7e]{-webkit-box-flex:.9;-webkit-flex:.9;flex:.9}.listWrapper .colInfo[data-v-1edcdd7e]{-webkit-box-flex:2;-webkit-flex:2;flex:2;padding-right:70px;padding-left:20px}.listWrapper .colPrice[data-v-1edcdd7e],.listWrapper .colStatus[data-v-1edcdd7e]{-webkit-box-flex:2;-webkit-flex:2;flex:2}.listWrapper .colOptions[data-v-1edcdd7e]{-webkit-box-flex:1.4;-webkit-flex:1.4;flex:1.4}.listWrapper .listContent-item[data-v-1edcdd7e]{margin-top:10px}.listWrapper .listContent-item-top[data-v-1edcdd7e]{color:#666;font-size:12px;background-color:#f7f7f7;padding:8px 30px;border:1px solid #dedede;border-bottom:none}.listWrapper .listContent-item-top>[data-v-1edcdd7e]{margin-right:2em}.listWrapper .listContent-item-top .time[data-v-1edcdd7e]{color:#333}.listWrapper .listContent-item-content[data-v-1edcdd7e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:20px;color:#666;border:1px solid #dedede;border-top:none}.listWrapper .listContent-item-content-image[data-v-1edcdd7e]{width:90px}.listWrapper .listContent-item-content-image img[data-v-1edcdd7e]{width:100%}.listWrapper .listContent-item-content-info b[data-v-1edcdd7e]{display:inline-block;height:2.8em}.listWrapper .listContent-item-content-info p[data-v-1edcdd7e]{margin:4px 0 0;color:#999}.listWrapper .listContent-item-content-price>p[data-v-1edcdd7e]{margin-bottom:2px}.listWrapper .listContent-item-content-price label[data-v-1edcdd7e]{color:#999;font-size:12px}.listWrapper .listContent-item-content-price .totalPrice[data-v-1edcdd7e]{color:#ff5858}.listWrapper .listContent-item-content-price .totalPrice b[data-v-1edcdd7e]{font-size:24px}.listWrapper .listContent-item-content-options[data-v-1edcdd7e],.listWrapper .listContent-item-content-status[data-v-1edcdd7e]{text-align:center}.listWrapper .listContent-item-content-options>[data-v-1edcdd7e]{margin:2px 0}.listWrapper .paginationBar[data-v-1edcdd7e]{padding:40px 0;text-align:center}",document.head.appendChild(a);import{a2 as i,d as o,s as n,u as r,a as s,r as d,$ as l,ay as p,o as c,e as u,p as m,f as g,g as f,h as v,i as y,j as b,F as T,k as h,n as x,t as k,m as C,l as w}from"./index.2d5fe4a0.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.d20919a8.js";import"./raf.f5dd759a.js";import{s as I}from"./UIPagination.1bd96c98.js";import"./CloseOutlined.337001ad.js";import"./toString.89c3b3ed.js";import"./identity.ebd63cad.js";import"./debounce.4a39be88.js";import"./omit.5a7ef365.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.3ebd57b3.js";import"./CheckOutlined.75abf2fa.js";import"./index.52fb0b02.js";import"./index.0df6741a.js";import{M as P}from"./index.19c2fe03.js";import{s as S,a as R}from"./index.950404a6.js";import"./_baseProperty.70166afe.js";import{s as O}from"./UICountdown.0b78e056.js";import"./index.368c58b8.js";import{s as j}from"./UISpin.95446043.js";import{s as U}from"./UIInputSearch.0bf5d679.js";import{g as W}from"./dict.a53fee1f.js";import{s as z}from"./UIEmpty.e9a6960e.js";import{s as E}from"./index.8e56e72d.js";import{s as N}from"./UIButton.ca857b3c.js";import"./UIModal.472e2844.js";import{d as _,o as D}from"./index.67855752.js";import{s as A}from"./index.b628da8d.js";import{s as q,a as M}from"./UITabPane.d87cba3c.js";import{o as $}from"./orderConfirm.c1558a45.js";const B=[{title:"全部",key:"all"},{title:"近三个月订单",key:"threeMonth"},{title:"近一个月订单",key:"oneMonth"},{title:"最近七天订单",key:"week"}],L={all:[],threeMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]})(),oneMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]})(),week:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]})()},Y=e=>JSON.parse(JSON.stringify({dateRange:e,startDate:L[e][0]&&_(L[e][0]),endDate:L[e][1]&&_(L[e][1])}));var K=o({name:"OrderTabPane",components:{UITabPane:q,UIButton:N,UIDropdown:S,Icon:n,UIPagination:I,UIEmpty:z,UISpin:j,UICountdown:O,PayRoutesPopover:R,PatentImage:E},props:{status:Number},setup({status:a}){const o=r(),n=s(),m=d(!1),g=d([]),f=d(!1),v=d(null),y=d(o.query),b=d(o.query.dateRange?B.find((e=>e.key===o.query.dateRange)):B[1]),T=l({total:0,current:1,size:10,pageSizeOptions:["10","30","50","100"],showSizeChange:(t,a)=>{window.scrollTo(0,0),n.push({path:"/user/preorder",query:e(e({},y.value),{size:a,no:1})})},change:t=>{window.scrollTo(0,0),n.push({path:"/user/preorder",query:e(e({},y.value),{no:t})})}}),h=o=>t(this,null,(function*(){if(m.value||(y.value.status||"999")!==(null==a?void 0:a.toString()))return;m.value=!0;const{data:t}=yield(n=e(e(e({size:T.size},Y(b.value.key)),o),{status:999===a?void 0:a}),i({url:"/api/v1/reserve",method:"get",params:n})).finally((()=>m.value=!1));var n;g.value=(null==t?void 0:t.list)||[],T.total=null==t?void 0:t.totalCount,T.current=null==t?void 0:t.no,T.size=null==t?void 0:t.size}));p((e=>{e.query.status===(a&&a.toString())&&(y.value=e.query,h(e.query))})),c((()=>{h(y.value)}));return{loading:m,submitLoading:f,paginationOptions:T,payRoutesPopoverRef:v,preorders:g,routeQuery:y,payOrder:(e,a)=>t(this,[e,a],(function*({payRoute:e,tradeType:t},a){f.value=!1,v.value.visible=!1;const{data:i}=yield $({commodityId:a.productId,commodityType:"PATENT",payRoute:e,tradeType:t}).finally((()=>f.value=!1)),{orderNo:o,tradeNo:r}=i,s=`/order/pay/${"UMS_PAY"===e?"code":"WXPAY"===e?"wechat":"form"}?orderNo=${o}&tradeNo=${r}&type=PATENT&payRoute=${e}&tradeType=${t}`;"UMS_PAY"===e||"WXPAY"===e?yield n.push(s):(A({tradeNo:r,orderNo:o,type:"PATENT",getContainer:"preorderTabPane"}),D(s))})),PREORDER_STATUS:W,optionOrder:e=>t(this,null,(function*(){P.confirm({centered:!0,class:"warningModal",title:"确定要取消该预留吗？",okType:"danger",content:"若取消预留今日将不能再次预留且积分不再返还",onOk:()=>t(this,null,(function*(){const t=u.loading("正在取消预留，请稍候...",0);var a;yield(a=e.id,i({url:`/api/v1/reserve/cancel/${a}`,method:"put"})).finally((()=>t())),u.success("取消成功！"),yield h(y.value)}))})})),changeOrderStatus:e=>{g.value.find((t=>t.orderNo===e.orderNo)).status=W.CANCEL,g.value=[...g.value]},changeOrderTimeRange:e=>{b.value=B.find((t=>t.key===e)),n.push({path:"/user/preorder",query:Y(e)})},orderTimeRange:B,currentOrderTimeRange:b}}});const J=C("data-v-1edcdd7e");m("data-v-1edcdd7e");const X={class:"listWrapper"},F={class:"listTitle"},H={class:"listTitle-item colTime"},Q={class:"orderTimeRangeSelect"},V=b("li",{class:"listTitle-item colInfo"},"订单详情",-1),G=b("li",{class:"listTitle-item colPrice"},"金额",-1),Z=b("li",{class:"listTitle-item colStatus"},"全部状态",-1),ee=b("li",{class:"listTitle-item colOptions"},"操作",-1),te={key:0,class:"emptyWrapper"},ae={class:"listContent"},ie={class:"listContent-item-top"},oe={class:"time"},ne={key:0},re={class:"listContent-item-content"},se={class:"listContent-item-content-image colTime"},de={class:"listContent-item-content-info colInfo"},le={class:"listContent-item-content-price colPrice"},pe=b("label",null,"价格：",-1),ce=b("label",null,"VIP会员：",-1),ue={class:"listContent-item-content-status colStatus"},me={class:"listContent-item-content-options colOptions"},ge=x("去下单"),fe=x("取消预留"),ve={class:"paginationBar"};g();const ye=J(((e,t,a,i,o,n)=>{const r=f("Icon"),s=f("UIDropdown"),d=f("UIEmpty"),l=f("PatentImage"),p=f("RouterLink"),c=(f("PayRoutesPopover"),f("UIButton")),u=f("UIPagination"),m=f("UISpin"),g=f("UITabPane");return v(),y(g,{id:"preorderTabPane"},{default:J((()=>[b("div",X,[b("ul",F,[b("li",H,[b(s,null,{overlay:J((()=>[b("ul",Q,[(v(!0),y(T,null,h(e.orderTimeRange,(t=>(v(),y("li",{class:[e.currentOrderTimeRange.key===t.key&&"active"],key:t.key,onClick:a=>e.changeOrderTimeRange(t.key)},k(t.title),11,["onClick"])))),128))])])),default:J((()=>[b("span",null,[x(k(e.currentOrderTimeRange.title)+" ",1),b(r,{icon:"down"})])])),_:1})]),V,G,Z,ee]),0===e.preorders.length?(v(),y("div",te,[b(d)])):(v(),y(m,{key:1,spinning:e.loading},{default:J((()=>[b("ul",ae,[(v(!0),y(T,null,h(e.preorders,(t=>(v(),y("li",{class:"listContent-item colTime",key:t.productId},[b("div",ie,[b("time",oe,k(t.createTime),1),t.orderNo?(v(),y("span",ne,"订单号："+k(t.orderNo),1)):w("",!0),b("span",null,"卖家："+k(t.sellerShopName),1)]),b("div",re,[b("div",se,[b(l,{category:t.productCategory},null,8,["category"])]),b("div",de,[b(p,{to:`/patent/${t.productNumber}`},{default:J((()=>[b("b",null,k(t.productName),1)])),_:2},1032,["to"]),b("p",null,"专利号："+k(t.productNumber),1)]),b("div",le,[b("p",null,[pe,x("￥"+k(t.productPrice),1)]),b("p",null,[ce,x("￥"+k(t.vipPrice),1)])]),b("div",ue,k(e.PREORDER_STATUS.label[t.status]),1),b("div",me,[t.status===e.PREORDER_STATUS.CREATED?(v(),y(T,{key:0},[b("span",null,"预定至 "+k(t.expireTime),1),w("",!0),b("div",null,[b(p,{to:{path:"/order/confirm",query:{commodityId:t.productId}}},{default:J((()=>[b(c,{type:"primary","customer-class":"mainButton"},{default:J((()=>[ge])),_:1})])),_:2},1032,["to"])]),b(c,{type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t)},{default:J((()=>[fe])),_:2},1032,["onClick"])],64)):w("",!0)])])])))),128))]),b("section",ve,[b(u,{size:"small",total:e.paginationOptions.total,"onUpdate:size":t[1]||(t[1]=t=>e.paginationOptions.size=t),current:e.paginationOptions.current,"onUpdate:current":t[2]||(t[2]=t=>e.paginationOptions.current=t),"page-size-options":e.paginationOptions.pageSizeOptions,"show-total":e=>`共 ${e} 条`,onChange:e.paginationOptions.change,onShowSizeChange:e.paginationOptions.showSizeChange,"show-size-changer":"","show-quick-jumper":""},null,8,["total","size","current","page-size-options","show-total","onChange","onShowSizeChange"])])])),_:1},8,["spinning"]))])])),_:1})}));K.render=ye,K.__scopeId="data-v-1edcdd7e";const be=[{title:"全部",key:999},{title:"预留中",key:W.CREATED},{title:"已下单",key:W.ORDER},{title:"已付款",key:W.PAYED},{title:"已取消",key:W.CANCEL}];var Te=o({name:"Order",components:{UITabs:M,OrderTabPane:K,UIInputSearch:U},setup(){const e=r(),t=s(),a=d(e.query.status);return{PREORDER_STATUS:W,activeKey:a,orderMap:be,changeTab:e=>{t.push({path:"/user/preorder",query:{status:999===e?void 0:e}})}}}});const he=C("data-v-f83f3c9e");m("data-v-f83f3c9e");const xe={class:"order"};g();const ke=he(((e,t,a,i,o,n)=>{const r=f("OrderTabPane"),s=f("UITabs");return v(),y("div",xe,[b(s,{animated:!1,activeKey:e.activeKey,onChange:e.changeTab},{default:he((()=>[(v(!0),y(T,null,h(e.orderMap,(e=>(v(),y(r,{key:e.key,status:e.key},{tab:he((()=>[b("b",null,k(e.title),1)])),_:2},1032,["status"])))),128))])),_:1},8,["activeKey","onChange"])])}));Te.render=ke,Te.__scopeId="data-v-f83f3c9e";export default Te;
