import{d as a,s,u as n,a as e,v as t,r as o,$ as i,e as r,p as c,f as d,g as p,h as l,i as u,j as I,aV as f,m,n as h}from"./index.e0d03852.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.9a0c2655.js";import"./raf.86450f37.js";import"./CloseOutlined.a544391c.js";import"./toString.7ea59509.js";import"./identity.16017226.js";import"./debounce.b5f9dfa3.js";import"./omit.ba35c8f5.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.189064d6.js";import"./index.718bdbc6.js";import"./index.bcf81b34.js";import"./index.1b896c71.js";import"./_baseProperty.d6ff4684.js";import{s as g,a as v}from"./UIFormItem.cb9fbe8d.js";import{s as b,u as j}from"./index.164c3699.js";import"./UICountdown.98708d11.js";import"./index.95770fae.js";import"./Col.725675a2.js";import"./dict.a53fee1f.js";import{s as U}from"./UIInput.c2bea5d3.js";import{s as w}from"./UIButton.5e81bc30.js";import{g as y}from"./index.3c366fab.js";import{a as _,s as x}from"./UITabPane.8760cfde.js";import{s as C}from"./signIn.a422f366.js";var B=a({name:"AuthSignIn",components:{UITabs:_,UITabPane:x,UIInput:U,Icon:s,UIButton:w,UIForm:g,UIFormItem:v,Captcha:b},setup(){const a=n(),s=e(),c=t(),d=o("signInWithPassword"),p=i({phone:"",password:"",captcha:""}),l=i({phone:[{required:!0,message:""},{len:11,message:""}],password:[{required:!0,message:""}],captcha:[{required:!1,message:""},{len:6,message:""}]}),{validate:u,validateInfos:I}=j(p,l),f=o(!1);return{activeTabKey:d,submitLoading:f,changeTag:a=>{l.captcha[0].required="signInWithCaptcha"===a,l.password[0].required="signInWithPassword"===a},signIn:()=>{u().then((async()=>{f.value=!0,await C[d.value](p).finally((()=>f.value=!1));const n=await c.dispatch("setUser");await c.dispatch("setOneDayConsumePoints"),await s.push(y(a.query.redirect)||"/"),r.success(`欢迎回来，${n.nickname}`)}),(()=>r.error("表单输入有误")))},signInInfo:p,validateInfos:I}}});const k=m("data-v-23747f29");c("data-v-23747f29");const P={class:"signIn"},T=I("b",null,"帐号密码登录",-1),K={class:"shrinkBar accountBar"},q={class:"passwordBar"},F=I("b",null,"手机动态登录",-1),L={class:"shrinkBar accountBar"},S={class:"captchaBar"},W={class:"buttonBar"},O=h("登录"),A={class:"infoBar"},$=h("还没有帐号，"),D=h("立即注册"),R=h("忘记密码");d();const V=k(((a,s,n,e,t,o)=>{const i=p("Icon"),r=p("UIInput"),c=p("UIFormItem"),d=p("UITabPane"),m=p("Captcha"),h=p("UITabs"),g=p("UIButton"),v=p("RouterLink"),b=p("UIForm");return l(),u("div",P,[I(b,{layout:"vertical"},{default:k((()=>[I(h,{animated:!1,activeKey:a.activeTabKey,"onUpdate:activeKey":s[5]||(s[5]=s=>a.activeTabKey=s),onChange:a.changeTag},{default:k((()=>[I(d,{key:"signInWithPassword"},{tab:k((()=>[T])),default:k((()=>[I(c,a.validateInfos.phone,{default:k((()=>[I("div",K,[I(r,{value:a.signInInfo.phone,"onUpdate:value":s[1]||(s[1]=s=>a.signInInfo.phone=s),placeholder:"请输入手机号",maxlength:11},{prefix:k((()=>[I(i,{class:"inputIcon",icon:"inputPhone"})])),_:1},8,["value"])])])),_:1},16),I(c,a.validateInfos.password,{default:k((()=>[I("div",q,[I(r,{value:a.signInInfo.password,"onUpdate:value":s[2]||(s[2]=s=>a.signInInfo.password=s),type:"password",placeholder:"请输入密码"},{prefix:k((()=>[I(i,{class:"inputIcon",icon:"inputPassword"})])),_:1},8,["value"])])])),_:1},16)])),_:1}),I(d,{key:"signInWithCaptcha"},{tab:k((()=>[F])),default:k((()=>[I(c,a.validateInfos.phone,{default:k((()=>[I("div",L,[I(r,{value:a.signInInfo.phone,"onUpdate:value":s[3]||(s[3]=s=>a.signInInfo.phone=s),placeholder:"请输入手机号",maxlength:11},{prefix:k((()=>[I(i,{class:"inputIcon",icon:"inputPhone"})])),_:1},8,["value"])])])),_:1},16),I(c,a.validateInfos.captcha,{default:k((()=>[I("div",S,[I(r,{value:a.signInInfo.captcha,"onUpdate:value":s[4]||(s[4]=s=>a.signInInfo.captcha=s),class:"captcha",placeholder:"验证码",maxlength:6,onKeydown:f(a.signIn,["enter"])},{prefix:k((()=>[I(i,{class:"inputIcon",icon:"inputCaptcha"})])),addonAfter:k((()=>[I(m,{info:a.signInInfo},null,8,["info"])])),_:1},8,["value","onKeydown"])])])),_:1},16)])),_:1})])),_:1},8,["activeKey","onChange"]),I("div",W,[I(g,{loading:a.submitLoading,type:"primary",block:"","customer-class":"mainButton",onClick:a.signIn},{default:k((()=>[O])),_:1},8,["loading","onClick"])]),I("div",A,[I("p",null,[$,I(v,{class:"toSignUp",to:"/auth/sign_up"},{default:k((()=>[D])),_:1})]),I(v,{class:"darkLink",to:"/auth/password"},{default:k((()=>[R])),_:1})])])),_:1})])}));B.render=V,B.__scopeId="data-v-23747f29";export default B;
