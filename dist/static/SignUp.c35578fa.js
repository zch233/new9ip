import{a2 as a,d as e,s,u as t,a as n,v as o,r,$ as i,e as p,p as l,f as d,g as c,h as u,i as f,j as m,m as I,n as h}from"./index.2d5fe4a0.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.d20919a8.js";import"./raf.f5dd759a.js";import"./CloseOutlined.337001ad.js";import"./toString.89c3b3ed.js";import"./identity.ebd63cad.js";import"./debounce.4a39be88.js";import"./omit.5a7ef365.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.3ebd57b3.js";import"./index.52fb0b02.js";import"./index.0df6741a.js";import"./index.19c2fe03.js";import"./_baseProperty.70166afe.js";import{s as v,a as U}from"./UIFormItem.a89e1c11.js";import{s as g,u as b}from"./index.1cee4715.js";import"./UICountdown.0b78e056.js";import"./index.368c58b8.js";import"./Col.b1474ae0.js";import"./dict.a53fee1f.js";import{s as j}from"./UIInput.ee8f6ead.js";import{s as y}from"./UIButton.ca857b3c.js";import{g as _}from"./index.67855752.js";import{a as x,s as B}from"./UITabPane.d87cba3c.js";import{a as k}from"./signIn.cbab2c9a.js";var w=e({name:"AuthSignUp",components:{UITabs:x,UITabPane:B,UIInput:j,Icon:s,UIButton:y,UIForm:v,UIFormItem:U,Captcha:g},setup(){const e=t(),s=n(),l=o(),d=r(!1),c=i({phone:"",password:"",captcha:"",referrer:_(e.query.code)||""}),u=i({phone:[{required:!0,message:""},{len:11,message:""}],password:[{required:!0,message:""}],captcha:[{required:!0,message:""},{len:6,message:""}]}),{validate:f,validateInfos:m}=b(c,u);return{route:e,signUpInfo:c,validateInfos:m,submitLoading:d,signUp:()=>{f().then((()=>{return t=this,n=null,o=function*(){var t;d.value=!0,yield(t=c,a({url:"/pub/api/v1/authc/regByMobile",method:"post",data:t})).finally((()=>d.value=!1)),p.success("注册成功!");const n=p.loading("正在为您自动登录...");d.value=!0,yield k(c);const o=yield l.dispatch("setUser").finally((()=>n()));yield s.push(_(e.query.redirect)||"/"),p.success(`欢迎回来，${o.nickname}`)},new Promise(((a,e)=>{var s=a=>{try{i(o.next(a))}catch(a){e(a)}},r=a=>{try{i(o.throw(a))}catch(a){e(a)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,r);i((o=o.apply(t,n)).next())}));var t,n,o}),(()=>p.error("表单输入有误")))}}}});const C=I("data-v-35062749");l("data-v-35062749");const P={class:"signUp"},q=m("b",null,"新用户注册",-1),F={class:"shrinkBar accountBar"},L={class:"shrinkBar captchaBar"},S={class:"shrinkBar passwordBar"},T={class:"referrerBar"},A={class:"buttonBar"},O=h("注册"),$={class:"infoBar"},M=h("点击注册代表已同意 "),R=h("《用户服务协议》"),z=h("返回登录");d();const D=C(((a,e,s,t,n,o)=>{const r=c("Icon"),i=c("UIInput"),p=c("UIFormItem"),l=c("Captcha"),d=c("UITabPane"),I=c("UITabs"),h=c("UIButton"),v=c("RouterLink"),U=c("UIForm");return u(),f("div",P,[m(U,{layout:"vertical"},{default:C((()=>[m(I,{animated:!1},{default:C((()=>[m(d,{key:"signUp"},{tab:C((()=>[q])),default:C((()=>[m(p,a.validateInfos.phone,{default:C((()=>[m("div",F,[m(i,{value:a.signUpInfo.phone,"onUpdate:value":e[1]||(e[1]=e=>a.signUpInfo.phone=e),placeholder:"请输入手机号",maxlength:11},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputPhone"})])),_:1},8,["value"])])])),_:1},16),m(p,a.validateInfos.captcha,{default:C((()=>[m("div",L,[m(i,{value:a.signUpInfo.captcha,"onUpdate:value":e[2]||(e[2]=e=>a.signUpInfo.captcha=e),class:"captcha",placeholder:"验证码",maxlength:6},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputCaptcha"})])),addonAfter:C((()=>[m(l,{info:a.signUpInfo},null,8,["info"])])),_:1},8,["value"])])])),_:1},16),m(p,a.validateInfos.password,{default:C((()=>[m("div",S,[m(i,{value:a.signUpInfo.password,"onUpdate:value":e[3]||(e[3]=e=>a.signUpInfo.password=e),type:"password",placeholder:"请输入密码"},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputPassword"})])),_:1},8,["value"])])])),_:1},16),m(p,a.validateInfos.referrer,{default:C((()=>[m("div",T,[m(i,{readonly:!!a.route.query.code,value:a.signUpInfo.referrer,"onUpdate:value":e[4]||(e[4]=e=>a.signUpInfo.referrer=e),placeholder:"推荐人手机号或者工号（选填）",maxlength:11},{prefix:C((()=>[m(r,{class:"inputIcon",icon:"inputAgent"})])),_:1},8,["readonly","value"])])])),_:1},16)])),_:1})])),_:1}),m("div",A,[m(h,{loading:a.submitLoading,type:"primary",block:"","customer-class":"mainButton",onClick:a.signUp},{default:C((()=>[O])),_:1},8,["loading","onClick"])]),m("div",$,[m("p",null,[M,m(v,{class:"toSignUp",to:"/others/helper?aq=1-2"},{default:C((()=>[R])),_:1})]),m(v,{class:"darkLink",to:"/auth/sign_in"},{default:C((()=>[z])),_:1})])])),_:1})])}));w.render=D,w.__scopeId="data-v-35062749";export default w;
