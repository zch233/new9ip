var e=Object.assign,t=(e,t,a)=>new Promise(((n,o)=>{var i=e=>{try{r(a.next(e))}catch(e){o(e)}},s=e=>{try{r(a.throw(e))}catch(e){o(e)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,s);r((a=a.apply(e,t)).next())}));let a=document.createElement("style");a.innerHTML=".orderItemCountDown .ant-statistic-content{font-size:14px}.orderTimeRangeSelect[data-v-0b7c7980]{background-color:#fff;font-size:12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.orderTimeRangeSelect li[data-v-0b7c7980]{padding:8px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer}.orderTimeRangeSelect li.active[data-v-0b7c7980],.orderTimeRangeSelect li[data-v-0b7c7980]:hover{color:#333}.orderTimeRangeSelect li[data-v-0b7c7980]:last-child{border-bottom:none}.listWrapper[data-v-0b7c7980]{padding:10px 20px}.listWrapper .listTitle[data-v-0b7c7980]{background-color:#e8e8e8;display:-webkit-box;display:-webkit-flex;display:flex;text-align:center;color:#666;font-size:12px;padding:0 20px;border:1px solid #e8e8e8;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.listWrapper .listTitle-item[data-v-0b7c7980]{padding:16px 0;cursor:default}.listWrapper .listTitle-item.colTime[data-v-0b7c7980]{cursor:pointer}.listWrapper .colTime[data-v-0b7c7980]{-webkit-box-flex:.9;-webkit-flex:.9;flex:.9}.listWrapper .colInfo[data-v-0b7c7980]{-webkit-box-flex:2;-webkit-flex:2;flex:2;padding-right:70px;padding-left:20px}.listWrapper .colPrice[data-v-0b7c7980],.listWrapper .colStatus[data-v-0b7c7980]{-webkit-box-flex:2;-webkit-flex:2;flex:2}.listWrapper .colOptions[data-v-0b7c7980]{-webkit-box-flex:1.4;-webkit-flex:1.4;flex:1.4}.listWrapper .listContent-item[data-v-0b7c7980]{margin-top:10px}.listWrapper .listContent-item-top[data-v-0b7c7980]{color:#666;font-size:12px;background-color:#f7f7f7;padding:8px 30px;border:1px solid #dedede;border-bottom:none}.listWrapper .listContent-item-top>[data-v-0b7c7980]{margin-right:2em}.listWrapper .listContent-item-top .time[data-v-0b7c7980]{color:#333}.listWrapper .listContent-item-content[data-v-0b7c7980]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:20px;color:#666;border:1px solid #dedede;border-top:none}.listWrapper .listContent-item-content-image[data-v-0b7c7980]{width:90px}.listWrapper .listContent-item-content-image img[data-v-0b7c7980]{width:100%}.listWrapper .listContent-item-content-info b[data-v-0b7c7980]{display:inline-block;height:2.8em}.listWrapper .listContent-item-content-info p[data-v-0b7c7980]{margin:4px 0 0;color:#999}.listWrapper .listContent-item-content-price>p[data-v-0b7c7980]{margin-bottom:2px}.listWrapper .listContent-item-content-price label[data-v-0b7c7980]{color:#999;font-size:12px}.listWrapper .listContent-item-content-price .totalPrice[data-v-0b7c7980]{color:#ff5858}.listWrapper .listContent-item-content-price .totalPrice b[data-v-0b7c7980]{font-size:24px}.listWrapper .listContent-item-content-options[data-v-0b7c7980],.listWrapper .listContent-item-content-status[data-v-0b7c7980]{text-align:center}.listWrapper .listContent-item-content-options>[data-v-0b7c7980]{margin:2px 0}.listWrapper .paginationBar[data-v-0b7c7980]{padding:40px 0;text-align:center}",document.head.appendChild(a);import{d as n,s as o,u as i,a as s,r,$ as l,ay as c,o as p,e as d,p as u,f as m,g as b,h as g,i as f,j as v,F as y,k as h,n as x,t as T,m as k}from"./index.2d5fe4a0.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.d20919a8.js";import"./raf.f5dd759a.js";import{s as C}from"./UIPagination.1bd96c98.js";import"./CloseOutlined.337001ad.js";import"./toString.89c3b3ed.js";import"./identity.ebd63cad.js";import"./debounce.4a39be88.js";import"./omit.5a7ef365.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.3ebd57b3.js";import"./CheckOutlined.75abf2fa.js";import"./index.52fb0b02.js";import"./index.0df6741a.js";import{M as w}from"./index.19c2fe03.js";import{s as S,a as O}from"./index.950404a6.js";import"./_baseProperty.70166afe.js";import{s as I}from"./UICountdown.0b78e056.js";import"./index.368c58b8.js";import{s as j}from"./UISpin.95446043.js";import{s as P}from"./UIInputSearch.0bf5d679.js";import{f as U}from"./dict.a53fee1f.js";import{s as R}from"./UIEmpty.e9a6960e.js";import{s as W}from"./index.8e56e72d.js";import{s as z}from"./UIButton.ca857b3c.js";import"./UIModal.472e2844.js";import{d as D,o as _}from"./index.67855752.js";import{s as A}from"./index.b628da8d.js";import{s as E,a as N}from"./UITabPane.d87cba3c.js";import{g as q,d as M,c as $}from"./order.e193a08d.js";const B=[{title:"全部",key:"all"},{title:"近三个月订单",key:"threeMonth"},{title:"近一个月订单",key:"oneMonth"},{title:"最近七天订单",key:"week"}],K={all:[],threeMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]})(),oneMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]})(),week:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]})()},L=e=>JSON.parse(JSON.stringify({dateRange:e,startDate:K[e][0]&&D(K[e][0]),endDate:K[e][1]&&D(K[e][1])}));var Y=n({name:"OrderTabPane",components:{UITabPane:E,UIButton:z,UIDropdown:S,Icon:o,UIPagination:C,UIEmpty:R,UISpin:j,UICountdown:I,PayRoutesPopover:O,PatentImage:W},props:{status:Number},setup({status:a}){const n=i(),o=s(),u=r(!1),m=r([]),b=r(n.query),g=r(n.query.dateRange?B.find((e=>e.key===n.query.dateRange)):B[1]),f=l({total:0,current:1,size:10,pageSizeOptions:["10","30","50","100"],showSizeChange:(t,a)=>{window.scrollTo(0,0),o.push({path:"/user/order",query:e(e({},b.value),{size:a,no:1})})},change:t=>{window.scrollTo(0,0),o.push({path:"/user/order",query:e(e({},b.value),{no:t})})}}),v=n=>t(this,null,(function*(){if(u.value||(b.value.status||"999")!==(null==a?void 0:a.toString()))return;u.value=!0;const{data:t}=yield q(e(e(e({size:f.size},L(g.value.key)),n),{status:999===a?void 0:a})).finally((()=>u.value=!1));m.value=(null==t?void 0:t.list)||[],f.total=null==t?void 0:t.totalCount,f.current=null==t?void 0:t.no,f.size=null==t?void 0:t.size}));c((e=>{b.value=e.query,v(e.query)})),p((()=>{v(b.value)}));return{loading:u,paginationOptions:f,orders:m,routeQuery:b,payOrder:(e,a)=>t(this,[e,a],(function*({payRoute:e,tradeType:t},a){const{orderNo:n,tradeNo:i}=a,s=`/order/pay/${"UMS_PAY"===e?"code":"WXPAY"===e?"wechat":"form"}?orderNo=${n}&tradeNo=${i}&type=PATENT&payRoute=${e}&tradeType=${t}`;"UMS_PAY"===e||"WXPAY"===e?yield o.push(s):(A({tradeNo:i,orderNo:n,type:"PATENT",getContainer:"orderTabPane"}),_(s))})),ORDER_STATUS:U,optionOrder:(e,a)=>t(this,null,(function*(){const n={delete:{label:"删除",requestApi:M},cancel:{label:"取消",requestApi:$}},{label:o,requestApi:i}=n[a];w.confirm({centered:!0,class:"warningModal",title:`确定要${o}该订单吗？`,okType:"danger",content:`若${o}订单将无法恢复`,onOk:()=>t(this,null,(function*(){const t=d.loading(`正在${o}订单，请稍候...`,0);yield i(e).finally((()=>t())),d.success(`${o}成功！`),yield v(b.value)}))})})),changeOrderStatus:e=>{m.value.find((t=>t.orderNo===e.orderNo)).status=U.CLOSED,m.value=[...m.value]},changeOrderTimeRange:e=>{g.value=B.find((t=>t.key===e)),o.push({path:"/user/order",query:L(e)})},orderTimeRange:B,currentOrderTimeRange:g}}});const F=k("data-v-0b7c7980");u("data-v-0b7c7980");const J={class:"listWrapper"},X={class:"listTitle"},H={class:"listTitle-item colTime"},Q={class:"orderTimeRangeSelect"},V=v("li",{class:"listTitle-item colInfo"},"订单详情",-1),G=v("li",{class:"listTitle-item colPrice"},"金额",-1),Z=v("li",{class:"listTitle-item colStatus"},"全部状态",-1),ee=v("li",{class:"listTitle-item colOptions"},"操作",-1),te={key:0,class:"emptyWrapper"},ae={class:"listContent"},ne={class:"listContent-item-top"},oe={class:"time"},ie={class:"listContent-item-content"},se={class:"listContent-item-content-image colTime"},re={class:"listContent-item-content-info colInfo"},le={class:"listContent-item-content-price colPrice"},ce=v("label",null,"原价：",-1),pe=v("label",null,"VIP会员：",-1),de={class:"totalPrice"},ue=v("label",null,"应付款：",-1),me=x("￥"),be={class:"listContent-item-content-status colStatus"},ge={class:"listContent-item-content-options colOptions"},fe=x("取消订单"),ve=x("删除订单"),ye={class:"paginationBar"};m();const he=F(((e,t,a,n,o,i)=>{const s=b("Icon"),r=b("UIDropdown"),l=b("UIEmpty"),c=b("PatentImage"),p=b("RouterLink"),d=b("UICountdown"),u=b("PayRoutesPopover"),m=b("UIButton"),k=b("UIPagination"),C=b("UISpin"),w=b("UITabPane");return g(),f(w,{id:"orderTabPane"},{default:F((()=>[v("div",J,[v("ul",X,[v("li",H,[v(r,null,{overlay:F((()=>[v("ul",Q,[(g(!0),f(y,null,h(e.orderTimeRange,(t=>(g(),f("li",{class:[e.currentOrderTimeRange.key===t.key&&"active"],key:t.key,onClick:a=>e.changeOrderTimeRange(t.key)},T(t.title),11,["onClick"])))),128))])])),default:F((()=>[v("span",null,[x(T(e.currentOrderTimeRange.title)+" ",1),v(s,{icon:"down"})])])),_:1})]),V,G,Z,ee]),0===e.orders.length?(g(),f("div",te,[v(l)])):(g(),f(C,{key:1,spinning:e.loading},{default:F((()=>[v("ul",ae,[(g(!0),f(y,null,h(e.orders,(t=>(g(),f("li",{class:"listContent-item colTime",key:t.orderNo},[v("div",ne,[v("time",oe,T(t.createTime),1),v("span",null,"订单号："+T(t.orderNo),1),v("span",null,"卖家："+T(t.sellerShopName),1)]),v("div",ie,[v("div",se,[v(c,{category:t.commodityCategory},null,8,["category"])]),v("div",re,[v(p,{to:`/patent/${t.number}`},{default:F((()=>[v("b",null,T(t.name),1)])),_:2},1032,["to"]),v("p",null,"专利号："+T(t.number),1)]),v("div",le,[v("p",null,[ce,x("￥"+T(t.price),1)]),(g(!0),f(y,null,h(t.discounts||[],(e=>(g(),f("p",{key:e.price},[pe,x("-￥"+T(e.price),1)])))),128)),v("p",de,[ue,me,v("b",null,T(t.totalAmount),1)])]),v("div",be,T(e.ORDER_STATUS.label[t.status]),1),v("div",ge,[t.status===e.ORDER_STATUS.CREATED?(g(),f(y,{key:0},[v(d,{class:"orderItemCountDown",onFinish:a=>e.changeOrderStatus(t),value:Date.now()+1e3*t.remainSecond,format:"剩余m分s秒"},null,8,["onFinish","value"]),v("div",null,[v(u,{onChoose:a=>e.payOrder(a,t)},null,8,["onChoose"])]),v(m,{type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t,"cancel")},{default:F((()=>[fe])),_:2},1032,["onClick"])],64)):(g(),f(m,{key:1,type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t,"delete")},{default:F((()=>[ve])),_:2},1032,["onClick"]))])])])))),128))]),v("section",ye,[v(k,{size:"small",total:e.paginationOptions.total,"onUpdate:size":t[1]||(t[1]=t=>e.paginationOptions.size=t),current:e.paginationOptions.current,"onUpdate:current":t[2]||(t[2]=t=>e.paginationOptions.current=t),"page-size-options":e.paginationOptions.pageSizeOptions,"show-total":e=>`共 ${e} 条`,onChange:e.paginationOptions.change,onShowSizeChange:e.paginationOptions.showSizeChange,"show-size-changer":"","show-quick-jumper":""},null,8,["total","size","current","page-size-options","show-total","onChange","onShowSizeChange"])])])),_:1},8,["spinning"]))])])),_:1})}));Y.render=he,Y.__scopeId="data-v-0b7c7980";const xe=[{title:"全部订单",key:999},{title:"待付款",key:U.CREATED},{title:"已付款",key:U.PAYED},{title:"已关闭",key:U.CLOSED}];var Te=n({name:"Order",components:{UITabs:N,OrderTabPane:Y,UIInputSearch:P},setup(){const e=i(),t=s(),a=r(Number(e.query.status||999));return{changeTab:e=>{t.push({path:"/user/order",query:{status:999===e?void 0:e}})},ORDER_STATUS:U,activeKey:a,orderMap:xe}}});const ke=k("data-v-70d7fb7b");u("data-v-70d7fb7b");const Ce={class:"order"};m();const we=ke(((e,t,a,n,o,i)=>{const s=b("OrderTabPane"),r=b("UITabs");return g(),f("div",Ce,[v(r,{animated:!1,activeKey:e.activeKey,"onUpdate:activeKey":t[1]||(t[1]=t=>e.activeKey=t),onChange:e.changeTab},{default:ke((()=>[(g(!0),f(y,null,h(e.orderMap,(e=>(g(),f(s,{key:e.key,status:e.key},{tab:ke((()=>[v("b",null,T(e.title),1)])),_:2},1032,["status"])))),128))])),_:1},8,["activeKey","onChange"])])}));Te.render=we,Te.__scopeId="data-v-70d7fb7b";export default Te;
