var e=Object.assign,t=(e,t,a)=>new Promise(((i,n)=>{var o=e=>{try{s(a.next(e))}catch(e){n(e)}},r=e=>{try{s(a.throw(e))}catch(e){n(e)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,r);s((a=a.apply(e,t)).next())}));let a=document.createElement("style");a.innerHTML=".orderItemCountDown .ant-statistic-content{font-size:14px}.orderTimeRangeSelect[data-v-0689c668]{background-color:#fff;font-size:12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.orderTimeRangeSelect li[data-v-0689c668]{padding:8px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer}.orderTimeRangeSelect li.active[data-v-0689c668],.orderTimeRangeSelect li[data-v-0689c668]:hover{color:#333}.orderTimeRangeSelect li[data-v-0689c668]:last-child{border-bottom:none}.listWrapper[data-v-0689c668]{padding:10px 20px}.listWrapper .listTitle[data-v-0689c668]{background-color:#e8e8e8;display:-webkit-box;display:-webkit-flex;display:flex;text-align:center;color:#666;font-size:12px;padding:0 20px;border:1px solid #e8e8e8;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.listWrapper .listTitle-item[data-v-0689c668]{padding:16px 0;cursor:default}.listWrapper .listTitle-item.colTime[data-v-0689c668]{cursor:pointer}.listWrapper .colTime[data-v-0689c668]{-webkit-box-flex:.9;-webkit-flex:.9;flex:.9}.listWrapper .colInfo[data-v-0689c668]{-webkit-box-flex:2;-webkit-flex:2;flex:2;padding-right:70px;padding-left:20px}.listWrapper .colPrice[data-v-0689c668],.listWrapper .colStatus[data-v-0689c668]{-webkit-box-flex:2;-webkit-flex:2;flex:2}.listWrapper .colOptions[data-v-0689c668]{-webkit-box-flex:1.4;-webkit-flex:1.4;flex:1.4}.listWrapper .listContent-item[data-v-0689c668]{margin-top:10px}.listWrapper .listContent-item-top[data-v-0689c668]{color:#666;font-size:12px;background-color:#f7f7f7;padding:8px 30px;border:1px solid #dedede;border-bottom:none}.listWrapper .listContent-item-top>[data-v-0689c668]{margin-right:2em}.listWrapper .listContent-item-top .time[data-v-0689c668]{color:#333}.listWrapper .listContent-item-content[data-v-0689c668]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:20px;color:#666;border:1px solid #dedede;border-top:none}.listWrapper .listContent-item-content-image[data-v-0689c668]{width:90px}.listWrapper .listContent-item-content-image img[data-v-0689c668]{width:100%}.listWrapper .listContent-item-content-info b[data-v-0689c668]{display:inline-block;height:2.8em}.listWrapper .listContent-item-content-info p[data-v-0689c668]{margin:4px 0 0;color:#999}.listWrapper .listContent-item-content-price>p[data-v-0689c668]{margin-bottom:2px}.listWrapper .listContent-item-content-price label[data-v-0689c668]{color:#999;font-size:12px}.listWrapper .listContent-item-content-price .totalPrice[data-v-0689c668]{color:#ff5858}.listWrapper .listContent-item-content-price .totalPrice b[data-v-0689c668]{font-size:24px}.listWrapper .listContent-item-content-status[data-v-0689c668]{text-align:center}.listWrapper .listContent-item-content-options[data-v-0689c668]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.listWrapper .listContent-item-content-options-optionsWrapper[data-v-0689c668]{-webkit-box-flex:1;-webkit-flex:1;flex:1;padding-left:20%}.listWrapper .listContent-item-content-options-optionsWrapper>[data-v-0689c668]{margin:2px 0}.listWrapper .emptyWrapper[data-v-0689c668]{padding:5em 0}",document.head.appendChild(a);import{d as i,s as n,u as o,a as r,r as s,a1 as l,aG as p,o as c,b8 as d,a9 as m,e as u,ba as g,a8 as b,p as f,f as v,h as y,i as k,j as h,k as x,F as T,l as C,t as w,m as S,n as I,q as O}from"./index.2406af76.js";import"./SearchOutlined.2696ddae.js";import{s as U}from"./UIPagination.d45d2fa1.js";import"./toString.6a494669.js";import"./identity.56907ac8.js";import"./isSymbol.0b93f80b.js";import"./omit.f2c40704.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.6052c543.js";import"./CheckOutlined.ca6c3308.js";import"./index.b0fb50c6.js";import{s as P,a as W}from"./index.1256b458.js";import"./toNumber.a00a1c6e.js";import"./_baseProperty.c2553ce9.js";import{s as z}from"./UICountdown.610d2acf.js";import"./debounce.df29b46b.js";import"./index.fb1e261e.js";import{s as R}from"./UISpin.3648283c.js";import{s as j}from"./UIInputSearch.51dec0c3.js";import{s as _}from"./UIEmpty.13ca8bc7.js";import{s as D}from"./UIButton.124bc973.js";import{s as N}from"./index.9dd88e2d.js";import"./UIModal.42b19d24.js";import{s as E}from"./index.ca2f908b.js";import{s as A}from"./UITooltip.34577966.js";import{s as q,a as M}from"./UITabPane.3ef5eddb.js";import{g as $,d as B,c as K}from"./order.fb6e95fa.js";const L=[{title:"全部",key:"all"},{title:"近三个月订单",key:"threeMonth"},{title:"近一个月订单",key:"oneMonth"},{title:"最近七天订单",key:"week"}],Y={all:[],threeMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]})(),oneMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]})(),week:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]})()},F=e=>JSON.parse(JSON.stringify({dateRange:e,startDate:Y[e][0]&&g(Y[e][0]),endDate:Y[e][1]&&g(Y[e][1])}));var J=i({name:"OrderTabPane",components:{UITabPane:q,UIButton:D,UIDropdown:P,Icon:n,UIPagination:U,UIEmpty:_,UISpin:R,UICountdown:z,PayRoutesPopover:W,PatentImage:N,UITooltip:A},props:{status:Number},setup({status:a}){const i=o(),n=r(),g=s(!1),f=s([]),v=s(i.query),y=s(i.query.dateRange?L.find((e=>e.key===i.query.dateRange)):L[1]),k=l({total:0,current:1,pageSize:10,pageSizeOptions:["10","30","50","100"],showSizeChange:(t,a)=>{window.scrollTo(0,0),n.push({path:"/user/order",query:e(e({},v.value),{size:a,no:1})})},change:t=>{window.scrollTo(0,0),n.push({path:"/user/order",query:e(e({},v.value),{no:t})})}}),h=i=>t(this,null,(function*(){if(g.value||(v.value.status||"999")!==(null==a?void 0:a.toString()))return;g.value=!0;const{data:t}=yield $(e(e(e({size:k.pageSize},F(y.value.key)),i),{status:999===a?void 0:a})).finally((()=>g.value=!1));f.value=(null==t?void 0:t.list)||[],k.total=null==t?void 0:t.totalCount,k.current=null==t?void 0:t.no,k.pageSize=null==t?void 0:t.size}));p((e=>{v.value=e.query,h(e.query)})),c((()=>{h(v.value)}));return{loading:g,paginationOptions:k,orders:f,routeQuery:v,payOrder:(e,a)=>t(this,[e,a],(function*({payRoute:e,tradeType:t},a){const{orderNo:i,tradeNo:o}=a,r=`/order/pay/${"UMS_PAY"===e?"code":"WXPAY"===e?"wechat":"form"}?orderNo=${i}&tradeNo=${o}&type=PATENT&payRoute=${e}&tradeType=${t}`;"UMS_PAY"===e||"WXPAY"===e?yield n.push(r):(E({tradeNo:o,orderNo:i,type:"PATENT",getContainer:"orderTabPane"}),b(r))})),ORDER_STATUS:d,optionOrder:(e,a)=>t(this,null,(function*(){const i={delete:{label:"删除",requestApi:B},cancel:{label:"取消",requestApi:K}},{label:n,requestApi:o}=i[a];m.confirm({centered:!0,class:"warningModal",title:`确定要${n}该订单吗？`,okType:"danger",content:`若${n}订单将无法恢复`,onOk:()=>t(this,null,(function*(){const t=u.loading(`正在${n}订单，请稍候...`,0);yield o(e).finally((()=>t())),u.success(`${n}成功！`),yield h(v.value)}))})})),changeOrderStatus:e=>{f.value.find((t=>t.orderNo===e.orderNo)).status=d.CLOSED,f.value=[...f.value]},changeOrderTimeRange:e=>{y.value=L.find((t=>t.key===e)),n.push({path:"/user/order",query:F(e)})},orderTimeRange:L,currentOrderTimeRange:y}}});const X=O("data-v-0689c668");f("data-v-0689c668");const G={class:"listWrapper"},H={class:"listTitle"},Q={class:"listTitle-item colTime"},V={class:"orderTimeRangeSelect"},Z=x("li",{class:"listTitle-item colInfo"},"订单详情",-1),ee=x("li",{class:"listTitle-item colPrice"},"金额",-1),te=x("li",{class:"listTitle-item colStatus"},"全部状态",-1),ae=x("li",{class:"listTitle-item colOptions"},"操作",-1),ie={key:0,class:"emptyWrapper"},ne=S("去下单"),oe={class:"listContent"},re={class:"listContent-item-top"},se={class:"time"},le={class:"listContent-item-content"},pe={class:"listContent-item-content-image colTime"},ce={class:"listContent-item-content-info colInfo"},de={class:"listContent-item-content-price colPrice"},me=x("label",null,"原价：",-1),ue=x("label",null,"VIP会员：",-1),ge={class:"totalPrice"},be=x("label",null,"应付款：",-1),fe=S("￥"),ve={class:"listContent-item-content-status colStatus"},ye={class:"listContent-item-content-options colOptions"},ke={class:"listContent-item-content-options-optionsWrapper"},he=S("取消订单"),xe=S("删除订单"),Te={class:"paginationBar"};v();const Ce=X(((e,t,a,i,n,o)=>{const r=y("Icon"),s=y("UIDropdown"),l=y("UIButton"),p=y("RouterLink"),c=y("UIEmpty"),d=y("PatentImage"),m=y("UICountdown"),u=y("PayRoutesPopover"),g=y("UITooltip"),b=y("UIPagination"),f=y("UISpin"),v=y("UITabPane");return k(),h(v,{id:"orderTabPane"},{default:X((()=>[x("div",G,[x("ul",H,[x("li",Q,[x(s,null,{overlay:X((()=>[x("ul",V,[(k(!0),h(T,null,C(e.orderTimeRange,(t=>(k(),h("li",{class:[e.currentOrderTimeRange.key===t.key&&"active"],key:t.key,onClick:a=>e.changeOrderTimeRange(t.key)},w(t.title),11,["onClick"])))),128))])])),default:X((()=>[x("span",null,[S(w(e.currentOrderTimeRange.title)+" ",1),x(r,{icon:"down"})])])),_:1})]),Z,ee,te,ae]),0===e.orders.length?(k(),h("div",ie,[e.loading?I("v-if",!0):(k(),h(c,{key:0,image:"order",description:"暂无相关订单"},{default:X((()=>[x(p,{to:"/patent"},{default:X((()=>[x(l,{"customer-class":"mainButton",type:"primary"},{default:X((()=>[ne])),_:1})])),_:1})])),_:1}))])):(k(),h(f,{key:1,spinning:e.loading},{default:X((()=>[x("ul",oe,[(k(!0),h(T,null,C(e.orders,(t=>(k(),h("li",{class:"listContent-item colTime",key:t.orderNo},[x("div",re,[x("time",se,w(t.createTime),1),x("span",null,"订单号："+w(t.orderNo),1),x("span",null,"卖家："+w(t.sellerShopName),1)]),x("div",le,[x("div",pe,[x(d,{cover:t.commodityCover},null,8,["cover"])]),x("div",ce,[x(p,{to:`/patent/${t.commodityNumber}`},{default:X((()=>[x("b",null,w(t.commodityName),1)])),_:2},1032,["to"]),x("p",null,"专利号："+w(t.commodityNumber),1)]),x("div",de,[x("p",null,[me,S("￥"+w(t.commodityPrice),1)]),(k(!0),h(T,null,C(t.discounts||[],(e=>(k(),h("p",{key:e.price},[ue,S("-￥"+w(e.price),1)])))),128)),x("p",ge,[be,fe,x("b",null,w(t.totalAmount),1)])]),x("div",ve,w(e.ORDER_STATUS.label[t.status]),1),x("div",ye,[x("div",ke,[t.status===e.ORDER_STATUS.CREATED?(k(),h(T,{key:0},[x(m,{class:"orderItemCountDown",onFinish:a=>e.changeOrderStatus(t),value:t.expireTime,format:"剩余m分s秒"},null,8,["onFinish","value"]),x("div",null,[x(u,{onChoose:a=>e.payOrder(a,t)},null,8,["onChoose"])]),x(l,{type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t,"cancel")},{default:X((()=>[he])),_:2},1032,["onClick"])],64)):(k(),h(l,{key:1,type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t,"delete")},{default:X((()=>[xe])),_:2},1032,["onClick"]))]),x(g,{title:t.remark},{default:X((()=>[t.remark?(k(),h(r,{key:0,icon:"remark"})):I("v-if",!0)])),_:2},1032,["title"])])])])))),128))]),x("section",Te,[x(b,{size:"small",total:e.paginationOptions.total,pageSize:e.paginationOptions.pageSize,"onUpdate:pageSize":t[1]||(t[1]=t=>e.paginationOptions.pageSize=t),current:e.paginationOptions.current,"onUpdate:current":t[2]||(t[2]=t=>e.paginationOptions.current=t),"page-size-options":e.paginationOptions.pageSizeOptions,"show-total":e=>`共 ${e} 条`,onChange:e.paginationOptions.change,onShowSizeChange:e.paginationOptions.showSizeChange,"show-size-changer":"","show-quick-jumper":""},null,8,["total","pageSize","current","page-size-options","show-total","onChange","onShowSizeChange"])])])),_:1},8,["spinning"]))])])),_:1})}));J.render=Ce,J.__scopeId="data-v-0689c668";const we=[{title:"全部订单",key:999},{title:"待付款",key:d.CREATED},{title:"已付款",key:d.PAYED},{title:"已关闭",key:d.CLOSED}];var Se=i({name:"Order",components:{UITabs:M,OrderTabPane:J,UIInputSearch:j},setup(){const e=o(),t=r(),a=s(Number(e.query.status||999));return{changeTab:e=>{t.push({path:"/user/order",query:{status:999===e?void 0:e}})},ORDER_STATUS:d,activeKey:a,orderMap:we}}});const Ie=O("data-v-70d7fb7b");f("data-v-70d7fb7b");const Oe={class:"order"};v();const Ue=Ie(((e,t,a,i,n,o)=>{const r=y("OrderTabPane"),s=y("UITabs");return k(),h("div",Oe,[x(s,{animated:!1,activeKey:e.activeKey,"onUpdate:activeKey":t[1]||(t[1]=t=>e.activeKey=t),onChange:e.changeTab},{default:Ie((()=>[I('      <template #tabBarExtraContent><div style="padding: 0 20px;">'),I('        <UIInputSearch placeholder="搜索订单号/订单名称" />'),I("      </div></template>"),(k(!0),h(T,null,C(e.orderMap,(e=>(k(),h(r,{key:e.key,status:e.key},{tab:Ie((()=>[x("b",null,w(e.title),1)])),_:2},1032,["status"])))),128))])),_:1},8,["activeKey","onChange"])])}));Se.render=Ue,Se.__scopeId="data-v-70d7fb7b";export default Se;
