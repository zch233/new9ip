import{a6 as a,d as e,s,u as t,a as n,x as o,r,a1 as i,b0 as p,e as l,p as d,f as c,h as u,i as f,j as m,k as I,q as h,m as v}from"./index.83e6bab9.js";import"./SearchOutlined.808d512f.js";import"./toString.5d6345b4.js";import"./identity.07d75f48.js";import"./isSymbol.8916c69b.js";import"./omit.369b0bb6.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.1c496972.js";import"./index.59a3b71a.js";import"./toNumber.5106673c.js";import"./_baseProperty.03a5e44c.js";import{s as U,a as b}from"./UIFormItem.a23bcfe2.js";import{s as g,u as y}from"./index.99d0f579.js";import"./UICountdown.35f18152.js";import"./debounce.2125f0b0.js";import"./index.dbf5e47f.js";import"./Col.52ae1e97.js";import{s as j}from"./UIButton.d42399db.js";import{s as _}from"./UIInput.e85bd402.js";import{a as x,s as B}from"./UITabPane.b1508bdf.js";import{a as k}from"./signIn.ba6e3db1.js";var w=e({name:"AuthSignUp",components:{UITabs:x,UITabPane:B,UIInput:_,Icon:s,UIButton:j,UIForm:U,UIFormItem:b,Captcha:g},setup(){const e=t(),s=n(),d=o(),c=r(!1),u=i({phone:"",password:"",captcha:"",referrer:p(e.query.code)||""}),f=i({phone:[{required:!0,message:""},{len:11,message:""}],password:[{required:!0,message:""}],captcha:[{required:!0,message:""},{len:6,message:""}]}),{validate:m,validateInfos:I}=y(u,f);return{route:e,signUpInfo:u,validateInfos:I,submitLoading:c,signUp:()=>{m().then((()=>{return t=this,n=null,o=function*(){var t;c.value=!0,yield(t=u,a({url:"/pub/api/v1/authc/regByMobile",method:"post",data:t})).finally((()=>c.value=!1)),l.success("注册成功!");const n=l.loading("正在为您自动登录...");c.value=!0,yield k(u);const o=yield d.dispatch("setUser").finally((()=>n()));yield s.push(p(e.query.redirect)||"/"),l.success(`欢迎回来，${o.nickname}`)},new Promise(((a,e)=>{var s=a=>{try{i(o.next(a))}catch(a){e(a)}},r=a=>{try{i(o.throw(a))}catch(a){e(a)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,r);i((o=o.apply(t,n)).next())}));var t,n,o}),(()=>l.error("表单输入有误")))}}}});const q=h("data-v-35062749");d("data-v-35062749");const P={class:"signUp"},C=I("b",null,"新用户注册",-1),S={class:"shrinkBar accountBar"},F={class:"shrinkBar captchaBar"},L={class:"shrinkBar passwordBar"},T={class:"referrerBar"},A={class:"buttonBar"},O=v("注册"),M={class:"infoBar"},N=v("点击注册代表已同意 "),R=v("《用户服务协议》"),$=v("返回登录");c();const z=q(((a,e,s,t,n,o)=>{const r=u("Icon"),i=u("UIInput"),p=u("UIFormItem"),l=u("Captcha"),d=u("UITabPane"),c=u("UITabs"),h=u("UIButton"),v=u("RouterLink"),U=u("UIForm");return f(),m("div",P,[I(U,{layout:"vertical"},{default:q((()=>[I(c,{animated:!1},{default:q((()=>[I(d,{key:"signUp"},{tab:q((()=>[C])),default:q((()=>[I(p,a.validateInfos.phone,{default:q((()=>[I("div",S,[I(i,{value:a.signUpInfo.phone,"onUpdate:value":e[1]||(e[1]=e=>a.signUpInfo.phone=e),placeholder:"请输入手机号",maxlength:11},{prefix:q((()=>[I(r,{class:"inputIcon",icon:"inputPhone"})])),_:1},8,["value"])])])),_:1},16),I(p,a.validateInfos.captcha,{default:q((()=>[I("div",F,[I(i,{value:a.signUpInfo.captcha,"onUpdate:value":e[2]||(e[2]=e=>a.signUpInfo.captcha=e),class:"captcha",placeholder:"验证码",maxlength:6},{prefix:q((()=>[I(r,{class:"inputIcon",icon:"inputCaptcha"})])),addonAfter:q((()=>[I(l,{info:a.signUpInfo},null,8,["info"])])),_:1},8,["value"])])])),_:1},16),I(p,a.validateInfos.password,{default:q((()=>[I("div",L,[I(i,{value:a.signUpInfo.password,"onUpdate:value":e[3]||(e[3]=e=>a.signUpInfo.password=e),type:"password",placeholder:"请输入密码"},{prefix:q((()=>[I(r,{class:"inputIcon",icon:"inputPassword"})])),_:1},8,["value"])])])),_:1},16),I(p,a.validateInfos.referrer,{default:q((()=>[I("div",T,[I(i,{readonly:!!a.route.query.code,value:a.signUpInfo.referrer,"onUpdate:value":e[4]||(e[4]=e=>a.signUpInfo.referrer=e),placeholder:"推荐人手机号或者工号（选填）",maxlength:11},{prefix:q((()=>[I(r,{class:"inputIcon",icon:"inputAgent"})])),_:1},8,["readonly","value"])])])),_:1},16)])),_:1})])),_:1}),I("div",A,[I(h,{loading:a.submitLoading,type:"primary",block:"","customer-class":"mainButton",onClick:a.signUp},{default:q((()=>[O])),_:1},8,["loading","onClick"])]),I("div",M,[I("p",null,[N,I(v,{class:"toSignUp",to:"/others/helper?aq=1-2"},{default:q((()=>[R])),_:1})]),I(v,{class:"darkLink",to:"/auth/sign_in"},{default:q((()=>[$])),_:1})])])),_:1})])}));w.render=z,w.__scopeId="data-v-35062749";export default w;
