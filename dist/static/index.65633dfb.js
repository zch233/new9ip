var e=(e,t,a)=>new Promise(((s,n)=>{var o=e=>{try{r(a.next(e))}catch(t){n(t)}},l=e=>{try{r(a.throw(e))}catch(t){n(t)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,l);r((a=a.apply(e,t)).next())}));import{d as t,_ as a,r as s,au as n,x as o,A as l,D as r,F as i,G as c,H as u,J as d,M as p,b as v,N as m,V as b,q as f,u as P,s as y,al as I,Q as h,K as _,O as C}from"./index.ac0cd7df.js";import{s as g}from"./collect.0a1214dd.js";import{_ as k}from"./UIButton.91505643.js";import{_ as x}from"./UIModal.d7a0acc4.js";import{p as B}from"./patent.d129ceee.js";var w=t({name:"starIcon",components:{Icon:a},props:{complex:Boolean,patent:{type:Object,default:()=>({})}},setup(t,a){const r=s(!1),{patent:i}=n(t),c=s(!1);return o((()=>{c.value=i.value.collected})),{patent:i,collected:c,optionPatent:()=>e(this,null,(function*(){r.value||(r.value=!0,yield g(i.value.id).finally((()=>r.value=!1)),l.success(c.value?"已从我的收藏移除":"已加入我的收藏"),c.value=!c.value,a.emit("star",c.value))}))}}});const M=m("data-v-661df504");r("data-v-661df504");const j={key:0};i();const O=M(((e,t,a,s,n,o)=>{const l=c("Icon");return u(),d("div",{class:"starIcon",onClick:t[1]||(t[1]=(...t)=>e.optionPatent&&e.optionPatent(...t))},[e.complex?(u(),d("label",j,"收藏")):p("",!0),v(l,{icon:"star"+(e.collected?"_fill":"")},null,8,["icon"])])}));w.render=O,w.__scopeId="data-v-661df504";var U=t({name:"PreorderButton",components:{UIButton:k,UIModal:x,Icon:a},props:{patent:{type:Object,default:()=>({})},big:Boolean,disabled:Boolean,size:String,buttonClass:String},setup(t){const a=b(),n=f(),o=P(),r=s(!1);return{userPoints:y((()=>a.getters.userPoints)),oneDayConsumePoints:y((()=>a.getters.oneDayConsumePoints)),preorderPatent:()=>e(this,null,(function*(){yield B({days:1,productId:t.patent.id}).finally((()=>r.value=!1)),l.success("预留成功"),yield n.push("/user/preorder"),a.commit("COMMIT_consumePointsByPreorder")})),visible:r,showModal:()=>{if(!a.state.user.account)return l.error("您尚未登录"),void n.push({path:"/auth/sign_in",query:{redirect:o.fullPath}});a.state.oneDayConsumePoints>a.state.userPoints?I.confirm({title:"积分不足",content:"抱歉，您的剩余积分不足",okText:"立即充值",cancelText:"继续逛逛",onOk(){n.push("/vip")}}):r.value=!0}}}});const D=m("data-v-7feb0d25");r("data-v-7feb0d25");const z=C("预留"),T={class:"wrapper"},q=C("将消耗 "),S=C(" 个积分，是否继续？"),A=C("当前剩余："),F=C(" 积分");i();const G=D(((e,t,a,s,n,o)=>{const l=c("UIButton"),r=c("Icon"),i=c("UIModal");return u(),d(_,null,[v(l,{size:e.size,class:["preorderButton",[e.big&&"big",e.buttonClass]],disabled:e.disabled,"customer-class":"default",onClick:e.showModal},{default:D((()=>[z])),_:1},8,["size","class","disabled","onClick"]),v(i,{width:416,visible:e.visible,"onUpdate:visible":t[1]||(t[1]=t=>e.visible=t),maskClosable:!1,title:"预留专利",onOk:e.preorderPatent},{default:D((()=>[v("div",T,[v(r,{class:"warning",icon:"warning"}),v("div",null,[v("p",null,[v("b",null,"预留专利："+h(e.patent.name),1)]),v("p",null,[q,v("b",null,h(e.oneDayConsumePoints),1),S]),v("span",null,[A,v("b",null,h(e.userPoints),1),F])])])])),_:1},8,["visible","onOk"])],64)}));U.render=G,U.__scopeId="data-v-7feb0d25";export{w as _,U as a};
