let e=document.createElement("style");e.innerHTML=".orderItemCountDown .ant-statistic-content{font-size:14px}.orderTimeRangeSelect[data-v-aaa59f14]{background-color:#fff;font-size:12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.orderTimeRangeSelect li[data-v-aaa59f14]{padding:8px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer}.orderTimeRangeSelect li.active[data-v-aaa59f14],.orderTimeRangeSelect li[data-v-aaa59f14]:hover{color:#333}.orderTimeRangeSelect li[data-v-aaa59f14]:last-child{border-bottom:none}.listWrapper[data-v-aaa59f14]{padding:10px 20px}.listWrapper .listTitle[data-v-aaa59f14]{background-color:#e8e8e8;display:flex;text-align:center;color:#666;font-size:12px;padding:0 20px;border:1px solid #e8e8e8;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.listWrapper .listTitle-item[data-v-aaa59f14]{padding:16px 0;cursor:default}.listWrapper .listTitle-item.colTime[data-v-aaa59f14]{cursor:pointer}.listWrapper .colTime[data-v-aaa59f14]{flex:.9}.listWrapper .colInfo[data-v-aaa59f14]{flex:2;padding-right:70px;padding-left:20px}.listWrapper .colPrice[data-v-aaa59f14],.listWrapper .colStatus[data-v-aaa59f14]{flex:2}.listWrapper .colOptions[data-v-aaa59f14]{flex:1.4}.listWrapper .listContent-item[data-v-aaa59f14]{margin-top:10px}.listWrapper .listContent-item-top[data-v-aaa59f14]{color:#666;font-size:12px;background-color:#f7f7f7;padding:8px 30px;border:1px solid #dedede;border-bottom:none}.listWrapper .listContent-item-top>[data-v-aaa59f14]{margin-right:2em}.listWrapper .listContent-item-top .time[data-v-aaa59f14]{color:#333}.listWrapper .listContent-item-content[data-v-aaa59f14]{display:flex;align-items:center;padding:20px;color:#666;border:1px solid #dedede;border-top:none}.listWrapper .listContent-item-content-image[data-v-aaa59f14]{width:90px}.listWrapper .listContent-item-content-image img[data-v-aaa59f14]{width:100%}.listWrapper .listContent-item-content-info b[data-v-aaa59f14]{display:inline-block;height:2.8em}.listWrapper .listContent-item-content-info p[data-v-aaa59f14]{margin:4px 0 0;color:#999}.listWrapper .listContent-item-content-price>p[data-v-aaa59f14]{margin-bottom:2px}.listWrapper .listContent-item-content-price label[data-v-aaa59f14]{color:#999;font-size:12px}.listWrapper .listContent-item-content-price .totalPrice[data-v-aaa59f14]{color:#ff5858}.listWrapper .listContent-item-content-price .totalPrice b[data-v-aaa59f14]{font-size:24px}.listWrapper .listContent-item-content-options[data-v-aaa59f14],.listWrapper .listContent-item-content-status[data-v-aaa59f14]{text-align:center}.listWrapper .listContent-item-content-options>[data-v-aaa59f14]{margin:2px 0}.listWrapper .paginationBar[data-v-aaa59f14]{padding:40px 0;text-align:center}",document.head.appendChild(e);import{d as t,s as a,u as n,a as o,r as i,$ as s,ay as r,o as l,e as p,p as c,f as d,g as m,h as u,i as f,j as g,F as v,k as y,n as b,t as T,m as h}from"./index.e0d03852.js";import"./index.2a5bb8c2.js";import"./SearchOutlined.9a0c2655.js";import"./raf.86450f37.js";import{s as C}from"./UIPagination.80faac09.js";import"./CloseOutlined.a544391c.js";import"./toString.7ea59509.js";import"./identity.16017226.js";import"./debounce.b5f9dfa3.js";import"./omit.ba35c8f5.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.189064d6.js";import"./CheckOutlined.bc6362b3.js";import"./index.718bdbc6.js";import"./index.bcf81b34.js";import{M as k}from"./index.1b896c71.js";import{s as x,a as S}from"./index.969247a1.js";import"./_baseProperty.d6ff4684.js";import{s as O}from"./UICountdown.98708d11.js";import"./index.95770fae.js";import{s as w}from"./UISpin.a57088ab.js";import{s as I}from"./UIInputSearch.511cf753.js";import{f as U}from"./dict.a53fee1f.js";import{s as j}from"./UIEmpty.1c481d05.js";import{s as P}from"./index.58c3c00a.js";import{s as R}from"./UIButton.5e81bc30.js";import"./UIModal.ff47e4f6.js";import{b as W,o as z}from"./index.3c366fab.js";import{s as D}from"./index.5035bd48.js";import{s as _,a as A}from"./UITabPane.8760cfde.js";import{g as E,d as N,c as q}from"./order.80539abc.js";const M=[{title:"全部",key:"all"},{title:"近三个月订单",key:"threeMonth"},{title:"近一个月订单",key:"oneMonth"},{title:"最近七天订单",key:"week"}],$={all:[],threeMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]})(),oneMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]})(),week:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]})()},B=e=>JSON.parse(JSON.stringify({dateRange:e,startDate:$[e][0]&&W($[e][0]),endDate:$[e][1]&&W($[e][1])}));var K=t({name:"OrderTabPane",components:{UITabPane:_,UIButton:R,UIDropdown:x,Icon:a,UIPagination:C,UIEmpty:j,UISpin:w,UICountdown:O,PayRoutesPopover:S,PatentImage:P},props:{status:Number},setup({status:e}){const t=n(),a=o(),c=i(!1),d=i([]),m=i(t.query),u=i(t.query.dateRange?M.find((e=>e.key===t.query.dateRange)):M[1]),f=s({total:0,current:1,size:10,pageSizeOptions:["10","30","50","100"],showSizeChange:(e,t)=>{window.scrollTo(0,0),a.push({path:"/user/order",query:{...m.value,size:t,no:1}})},change:e=>{window.scrollTo(0,0),a.push({path:"/user/order",query:{...m.value,no:e}})}}),g=async t=>{if(c.value||(m.value.status||"999")!==e?.toString())return;c.value=!0;const{data:a}=await E({size:f.size,...B(u.value.key),...t,status:999===e?void 0:e}).finally((()=>c.value=!1));d.value=a?.list||[],f.total=a?.totalCount,f.current=a?.no,f.size=a?.size};r((e=>{m.value=e.query,g(e.query)})),l((()=>{g(m.value)}));return{loading:c,paginationOptions:f,orders:d,routeQuery:m,payOrder:async({payRoute:e,tradeType:t},n)=>{const{orderNo:o,tradeNo:i}=n,s=`/order/pay/${"UMS_PAY"===e?"code":"WXPAY"===e?"wechat":"form"}?orderNo=${o}&tradeNo=${i}&type=PATENT&payRoute=${e}&tradeType=${t}`;"UMS_PAY"===e||"WXPAY"===e?await a.push(s):(D({tradeNo:i,orderNo:o,type:"PATENT"}),z(s))},ORDER_STATUS:U,optionOrder:async(e,t)=>{const a={delete:{label:"删除",requestApi:N},cancel:{label:"取消",requestApi:q}},{label:n,requestApi:o}=a[t];k.confirm({centered:!0,class:"warningModal",title:`确定要${n}该订单吗？`,okType:"danger",content:`若${n}订单将无法恢复`,onOk:async()=>{const t=p.loading(`正在${n}订单，请稍候...`,0);await o(e).finally((()=>t())),p.success(`${n}成功！`),await g(m.value)}})},changeOrderStatus:e=>{d.value.find((t=>t.orderNo===e.orderNo)).status=U.CLOSED,d.value=[...d.value]},changeOrderTimeRange:e=>{u.value=M.find((t=>t.key===e)),a.push({path:"/user/order",query:B(e)})},orderTimeRange:M,currentOrderTimeRange:u}}});const L=h("data-v-aaa59f14");c("data-v-aaa59f14");const Y={class:"listWrapper"},F={class:"listTitle"},J={class:"listTitle-item colTime"},X={class:"orderTimeRangeSelect"},H=g("li",{class:"listTitle-item colInfo"},"订单详情",-1),Q=g("li",{class:"listTitle-item colPrice"},"金额",-1),V=g("li",{class:"listTitle-item colStatus"},"全部状态",-1),G=g("li",{class:"listTitle-item colOptions"},"操作",-1),Z={key:0,class:"emptyWrapper"},ee={class:"listContent"},te={class:"listContent-item-top"},ae={class:"time"},ne={class:"listContent-item-content"},oe={class:"listContent-item-content-image colTime"},ie={class:"listContent-item-content-info colInfo"},se={class:"listContent-item-content-price colPrice"},re=g("label",null,"原价：",-1),le=g("label",null,"VIP会员：",-1),pe={class:"totalPrice"},ce=g("label",null,"应付款：",-1),de=b("￥"),me={class:"listContent-item-content-status colStatus"},ue={class:"listContent-item-content-options colOptions"},fe=b("取消订单"),ge=b("删除订单"),ve={class:"paginationBar"};d();const ye=L(((e,t,a,n,o,i)=>{const s=m("Icon"),r=m("UIDropdown"),l=m("UIEmpty"),p=m("PatentImage"),c=m("RouterLink"),d=m("UICountdown"),h=m("PayRoutesPopover"),C=m("UIButton"),k=m("UIPagination"),x=m("UISpin"),S=m("UITabPane");return u(),f(S,{id:"orderTabPane"},{default:L((()=>[g("div",Y,[g("ul",F,[g("li",J,[g(r,null,{overlay:L((()=>[g("ul",X,[(u(!0),f(v,null,y(e.orderTimeRange,(t=>(u(),f("li",{class:[e.currentOrderTimeRange.key===t.key&&"active"],key:t.key,onClick:a=>e.changeOrderTimeRange(t.key)},T(t.title),11,["onClick"])))),128))])])),default:L((()=>[g("span",null,[b(T(e.currentOrderTimeRange.title)+" ",1),g(s,{icon:"down"})])])),_:1})]),H,Q,V,G]),0===e.orders.length?(u(),f("div",Z,[g(l)])):(u(),f(x,{key:1,spinning:e.loading},{default:L((()=>[g("ul",ee,[(u(!0),f(v,null,y(e.orders,(t=>(u(),f("li",{class:"listContent-item colTime",key:t.orderNo},[g("div",te,[g("time",ae,T(t.createTime),1),g("span",null,"订单号："+T(t.orderNo),1),g("span",null,"卖家："+T(t.sellerShopName),1)]),g("div",ne,[g("div",oe,[g(p,{category:t.commodityCategory},null,8,["category"])]),g("div",ie,[g(c,{to:`/patent/${t.number}`},{default:L((()=>[g("b",null,T(t.name),1)])),_:2},1032,["to"]),g("p",null,"专利号："+T(t.number),1)]),g("div",se,[g("p",null,[re,b("￥"+T(t.price),1)]),(u(!0),f(v,null,y(t.discounts||[],(e=>(u(),f("p",{key:e.price},[le,b("-￥"+T(e.price),1)])))),128)),g("p",pe,[ce,de,g("b",null,T(t.totalAmount),1)])]),g("div",me,T(e.ORDER_STATUS.label[t.status]),1),g("div",ue,[t.status===e.ORDER_STATUS.CREATED?(u(),f(v,{key:0},[g(d,{class:"orderItemCountDown",onFinish:a=>e.changeOrderStatus(t),value:Date.now()+1e3*t.remainSecond,format:"剩余m分s秒"},null,8,["onFinish","value"]),g("div",null,[g(h,{onChoose:a=>e.payOrder(a,t)},null,8,["onChoose"])]),g(C,{type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t,"cancel")},{default:L((()=>[fe])),_:2},1032,["onClick"])],64)):(u(),f(C,{key:1,type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t,"delete")},{default:L((()=>[ge])),_:2},1032,["onClick"]))])])])))),128))]),g("section",ve,[g(k,{size:"small",total:e.paginationOptions.total,"onUpdate:size":t[1]||(t[1]=t=>e.paginationOptions.size=t),current:e.paginationOptions.current,"onUpdate:current":t[2]||(t[2]=t=>e.paginationOptions.current=t),"page-size-options":e.paginationOptions.pageSizeOptions,"show-total":e=>`共 ${e} 条`,onChange:e.paginationOptions.change,onShowSizeChange:e.paginationOptions.showSizeChange,"show-size-changer":"","show-quick-jumper":""},null,8,["total","size","current","page-size-options","show-total","onChange","onShowSizeChange"])])])),_:1},8,["spinning"]))])])),_:1})}));K.render=ye,K.__scopeId="data-v-aaa59f14";const be=[{title:"全部订单",key:999},{title:"待付款",key:U.CREATED},{title:"已付款",key:U.PAYED},{title:"已关闭",key:U.CLOSED}];var Te=t({name:"Order",components:{UITabs:A,OrderTabPane:K,UIInputSearch:I},setup(){const e=n(),t=o(),a=i(Number(e.query.status||999));return{changeTab:e=>{t.push({path:"/user/order",query:{status:999===e?void 0:e}})},ORDER_STATUS:U,activeKey:a,orderMap:be}}});const he=h("data-v-70d7fb7b");c("data-v-70d7fb7b");const Ce={class:"order"};d();const ke=he(((e,t,a,n,o,i)=>{const s=m("OrderTabPane"),r=m("UITabs");return u(),f("div",Ce,[g(r,{animated:!1,activeKey:e.activeKey,"onUpdate:activeKey":t[1]||(t[1]=t=>e.activeKey=t),onChange:e.changeTab},{default:he((()=>[(u(!0),f(v,null,y(e.orderMap,(e=>(u(),f(s,{key:e.key,status:e.key},{tab:he((()=>[g("b",null,T(e.title),1)])),_:2},1032,["status"])))),128))])),_:1},8,["activeKey","onChange"])])}));Te.render=ke,Te.__scopeId="data-v-70d7fb7b";export default Te;
