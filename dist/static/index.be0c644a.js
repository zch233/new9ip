var e=Object.assign,t=(e,t,a)=>new Promise(((o,n)=>{var i=e=>{try{s(a.next(e))}catch(e){n(e)}},r=e=>{try{s(a.throw(e))}catch(e){n(e)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,r);s((a=a.apply(e,t)).next())}));let a=document.createElement("style");a.innerHTML=".orderItemCountDown .ant-statistic-content{font-size:14px}.orderTimeRangeSelect[data-v-f48afdde]{background-color:#fff;font-size:12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.orderTimeRangeSelect li[data-v-f48afdde]{padding:8px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer}.orderTimeRangeSelect li.active[data-v-f48afdde],.orderTimeRangeSelect li[data-v-f48afdde]:hover{color:#333}.orderTimeRangeSelect li[data-v-f48afdde]:last-child{border-bottom:none}.listWrapper[data-v-f48afdde]{padding:10px 20px}.listWrapper .listTitle[data-v-f48afdde]{background-color:#e8e8e8;display:-webkit-box;display:-webkit-flex;display:flex;text-align:center;color:#666;font-size:12px;padding:0 20px;border:1px solid #e8e8e8;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.listWrapper .listTitle-item[data-v-f48afdde]{padding:16px 0;cursor:default}.listWrapper .listTitle-item.colTime[data-v-f48afdde]{cursor:pointer}.listWrapper .colTime[data-v-f48afdde]{-webkit-box-flex:.9;-webkit-flex:.9;flex:.9}.listWrapper .colInfo[data-v-f48afdde]{-webkit-box-flex:2;-webkit-flex:2;flex:2;padding-right:70px;padding-left:20px}.listWrapper .colPrice[data-v-f48afdde],.listWrapper .colStatus[data-v-f48afdde]{-webkit-box-flex:2;-webkit-flex:2;flex:2}.listWrapper .colOptions[data-v-f48afdde]{-webkit-box-flex:1.4;-webkit-flex:1.4;flex:1.4}.listWrapper .listContent-item[data-v-f48afdde]{margin-top:10px}.listWrapper .listContent-item-top[data-v-f48afdde]{color:#666;font-size:12px;background-color:#f7f7f7;padding:8px 30px;border:1px solid #dedede;border-bottom:none}.listWrapper .listContent-item-top>[data-v-f48afdde]{margin-right:2em}.listWrapper .listContent-item-top .time[data-v-f48afdde]{color:#333}.listWrapper .listContent-item-content[data-v-f48afdde]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:20px;color:#666;border:1px solid #dedede;border-top:none}.listWrapper .listContent-item-content-image[data-v-f48afdde]{width:90px}.listWrapper .listContent-item-content-image img[data-v-f48afdde]{width:100%}.listWrapper .listContent-item-content-info b[data-v-f48afdde]{display:inline-block;height:2.8em}.listWrapper .listContent-item-content-info p[data-v-f48afdde]{margin:4px 0 0;color:#999}.listWrapper .listContent-item-content-price>p[data-v-f48afdde]{margin-bottom:2px}.listWrapper .listContent-item-content-price label[data-v-f48afdde]{color:#999;font-size:12px}.listWrapper .listContent-item-content-price .totalPrice[data-v-f48afdde]{color:#ff5858}.listWrapper .listContent-item-content-price .totalPrice b[data-v-f48afdde]{font-size:24px}.listWrapper .listContent-item-content-options[data-v-f48afdde],.listWrapper .listContent-item-content-status[data-v-f48afdde]{text-align:center}.listWrapper .listContent-item-content-options>[data-v-f48afdde]{margin:2px 0}",document.head.appendChild(a);import{a6 as o,d as n,s as i,u as r,a as s,r as l,a1 as d,aG as p,o as c,be as u,a9 as m,e as f,ba as g,a8 as v,p as b,f as y,h as T,i as h,j as x,k,F as C,l as w,t as S,m as P,n as I,q as R}from"./index.bbb49ce1.js";import"./SearchOutlined.075254d3.js";import{s as O}from"./UIPagination.c4f07cea.js";import"./toString.169a6b8a.js";import"./identity.7bed75cd.js";import"./isSymbol.e1f13a23.js";import"./omit.345cbca5.js";import"./_baseSlice.1123a25b.js";import"./LeftOutlined.a5bae9ce.js";import"./CheckOutlined.4ad504cf.js";import"./index.3020f164.js";import{s as U,a as j}from"./index.492dab65.js";import"./toNumber.20c061c4.js";import"./_baseProperty.7c17d158.js";import{s as z}from"./UICountdown.f65516fa.js";import"./debounce.b546389a.js";import"./index.01c4344b.js";import{s as W}from"./UISpin.8968ab96.js";import{s as E}from"./UIInputSearch.bcbba546.js";import{s as N}from"./UIEmpty.b7be20ab.js";import{s as _}from"./UIButton.acbd0656.js";import{s as D}from"./index.4c663c18.js";import"./UIModal.ede5aab1.js";import{s as A}from"./index.32e8483a.js";import{s as q}from"./index.d1f8e88e.js";import{s as M,a as $}from"./UITabPane.ff2467ef.js";import{o as B}from"./orderConfirm.a562169d.js";const L=[{title:"全部",key:"all"},{title:"近三个月订单",key:"threeMonth"},{title:"近一个月订单",key:"oneMonth"},{title:"最近七天订单",key:"week"}],Y={all:[],threeMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]})(),oneMonth:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]})(),week:(()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]})()},K=e=>JSON.parse(JSON.stringify({dateRange:e,startDate:Y[e][0]&&g(Y[e][0]),endDate:Y[e][1]&&g(Y[e][1])}));var J=n({name:"OrderTabPane",components:{UITabPane:M,UIButton:_,UIDropdown:U,Icon:i,UIPagination:O,UIEmpty:N,UISpin:W,UICountdown:z,PayRoutesPopover:j,PatentImage:D,PrePatentCountdown:q},props:{status:Number},setup({status:a}){const n=r(),i=s(),g=l(!1),b=l([]),y=l(!1),T=l(null),h=l(n.query),x=l(n.query.dateRange?L.find((e=>e.key===n.query.dateRange)):L[1]),k=d({total:0,current:1,pageSize:10,pageSizeOptions:["10","30","50","100"],showSizeChange:(t,a)=>{window.scrollTo(0,0),i.push({path:"/user/preorder",query:e(e({},h.value),{size:a,no:1})})},change:t=>{window.scrollTo(0,0),i.push({path:"/user/preorder",query:e(e({},h.value),{no:t})})}}),C=n=>t(this,null,(function*(){if(g.value||(h.value.status||"999")!==(null==a?void 0:a.toString()))return;g.value=!0;const{data:t}=yield(i=e(e(e({size:k.pageSize},K(x.value.key)),n),{status:999===a?void 0:a}),o({url:"/api/v1/reserve",method:"get",params:i})).finally((()=>g.value=!1));var i;b.value=(null==t?void 0:t.list)||[],k.total=null==t?void 0:t.totalCount,k.current=null==t?void 0:t.no,k.pageSize=null==t?void 0:t.size}));p((e=>{h.value=e.query,C(e.query)})),c((()=>{C(h.value)}));return{loading:g,submitLoading:y,paginationOptions:k,payRoutesPopoverRef:T,preorders:b,routeQuery:h,payOrder:(e,a)=>t(this,[e,a],(function*({payRoute:e,tradeType:t},a){y.value=!1,T.value.visible=!1;const{data:o}=yield B({commodityId:a.productId,commodityType:"PATENT",payRoute:e,tradeType:t}).finally((()=>y.value=!1)),{orderNo:n,tradeNo:r}=o,s=`/order/pay/${"UMS_PAY"===e?"code":"WXPAY"===e?"wechat":"form"}?orderNo=${n}&tradeNo=${r}&type=PATENT&payRoute=${e}&tradeType=${t}`;"UMS_PAY"===e||"WXPAY"===e?yield i.push(s):(A({tradeNo:r,orderNo:n,type:"PATENT",getContainer:"preorderTabPane"}),v(s))})),PREORDER_STATUS:u,optionOrder:e=>t(this,null,(function*(){m.confirm({centered:!0,class:"warningModal",title:"确定要取消该预留吗？",okType:"danger",content:"若取消预留今日将不能再次预留且积分不再返还",onOk:()=>t(this,null,(function*(){const t=f.loading("正在取消预留，请稍候...",0);var a;yield(a=e.id,o({url:`/api/v1/reserve/cancel/${a}`,method:"put"})).finally((()=>t())),f.success("取消成功！"),yield C(h.value)}))})})),changeOrderStatus:e=>{b.value.find((t=>t.orderNo===e.orderNo)).status=u.CANCEL,b.value=[...b.value]},changeOrderTimeRange:e=>{x.value=L.find((t=>t.key===e)),i.push({path:"/user/preorder",query:K(e)})},orderTimeRange:L,currentOrderTimeRange:x}}});const X=R("data-v-f48afdde");b("data-v-f48afdde");const F={class:"listWrapper"},G={class:"listTitle"},H={class:"listTitle-item colTime"},Q={class:"orderTimeRangeSelect"},V=k("li",{class:"listTitle-item colInfo"},"订单详情",-1),Z=k("li",{class:"listTitle-item colPrice"},"金额",-1),ee=k("li",{class:"listTitle-item colStatus"},"全部状态",-1),te=k("li",{class:"listTitle-item colOptions"},"操作",-1),ae={key:0,class:"emptyWrapper"},oe={class:"listContent"},ne={class:"listContent-item-top"},ie={class:"time"},re={key:0},se={class:"listContent-item-content"},le={class:"listContent-item-content-image colTime"},de={class:"listContent-item-content-info colInfo"},pe={class:"listContent-item-content-price colPrice"},ce=k("label",null,"价格：",-1),ue=k("label",null,"VIP会员：",-1),me={class:"listContent-item-content-status colStatus"},fe={class:"listContent-item-content-options colOptions"},ge=P("去下单"),ve=P("取消预留"),be={class:"paginationBar"};y();const ye=X(((e,t,a,o,n,i)=>{const r=T("Icon"),s=T("UIDropdown"),l=T("UIEmpty"),d=T("PatentImage"),p=T("RouterLink"),c=T("PrePatentCountdown"),u=(T("PayRoutesPopover"),T("UIButton")),m=T("UIPagination"),f=T("UISpin"),g=T("UITabPane");return h(),x(g,{id:"preorderTabPane"},{default:X((()=>[k("div",F,[k("ul",G,[k("li",H,[k(s,null,{overlay:X((()=>[k("ul",Q,[(h(!0),x(C,null,w(e.orderTimeRange,(t=>(h(),x("li",{class:[e.currentOrderTimeRange.key===t.key&&"active"],key:t.key,onClick:a=>e.changeOrderTimeRange(t.key)},S(t.title),11,["onClick"])))),128))])])),default:X((()=>[k("span",null,[P(S(e.currentOrderTimeRange.title)+" ",1),k(r,{icon:"down"})])])),_:1})]),V,Z,ee,te]),0===e.preorders.length?(h(),x("div",ae,[k(l)])):(h(),x(f,{key:1,spinning:e.loading},{default:X((()=>[k("ul",oe,[(h(!0),x(C,null,w(e.preorders,(t=>(h(),x("li",{class:"listContent-item colTime",key:t.productId},[k("div",ne,[k("time",ie,S(t.createTime),1),t.orderNo?(h(),x("span",re,"订单号："+S(t.orderNo),1)):I("",!0),k("span",null,"卖家："+S(t.sellerShopName),1)]),k("div",se,[k("div",le,[k(d,{cover:t.productCover},null,8,["cover"])]),k("div",de,[k(p,{to:`/patent/${t.productNumber}`},{default:X((()=>[k("b",null,S(t.productName),1)])),_:2},1032,["to"]),k("p",null,"专利号："+S(t.productNumber),1)]),k("div",pe,[k("p",null,[ce,P("￥"+S(t.productPrice),1)]),k("p",null,[ue,P("￥"+S(t.vipPrice),1)])]),k("div",me,S(e.PREORDER_STATUS.label[t.status]),1),k("div",fe,[t.status===e.PREORDER_STATUS.CREATED?(h(),x(C,{key:0},[k(c,{patent:t},null,8,["patent"]),I("",!0),k("div",null,[k(p,{to:{path:"/order/confirm",query:{commodityId:t.productId}}},{default:X((()=>[k(u,{type:"primary","customer-class":"mainButton"},{default:X((()=>[ge])),_:1})])),_:2},1032,["to"])]),k(u,{type:"link",size:"small","customer-class":"linkButton",onClick:a=>e.optionOrder(t)},{default:X((()=>[ve])),_:2},1032,["onClick"])],64)):I("",!0)])])])))),128))]),k("section",be,[k(m,{size:"small",total:e.paginationOptions.total,pageSize:e.paginationOptions.pageSize,"onUpdate:pageSize":t[1]||(t[1]=t=>e.paginationOptions.pageSize=t),current:e.paginationOptions.current,"onUpdate:current":t[2]||(t[2]=t=>e.paginationOptions.current=t),"page-size-options":e.paginationOptions.pageSizeOptions,"show-total":e=>`共 ${e} 条`,onChange:e.paginationOptions.change,onShowSizeChange:e.paginationOptions.showSizeChange,"show-size-changer":"","show-quick-jumper":""},null,8,["total","pageSize","current","page-size-options","show-total","onChange","onShowSizeChange"])])])),_:1},8,["spinning"]))])])),_:1})}));J.render=ye,J.__scopeId="data-v-f48afdde";const Te=[{title:"全部",key:999},{title:"预留中",key:u.CREATED},{title:"已下单",key:u.ORDER},{title:"已付款",key:u.PAYED},{title:"已取消",key:u.CANCEL}];var he=n({name:"Order",components:{UITabs:$,OrderTabPane:J,UIInputSearch:E},setup(){const e=r(),t=s(),a=l(e.query.status);return{PREORDER_STATUS:u,activeKey:a,orderMap:Te,changeTab:e=>{t.push({path:"/user/preorder",query:{status:999===e?void 0:e}})}}}});const xe=R("data-v-f83f3c9e");b("data-v-f83f3c9e");const ke={class:"order"};y();const Ce=xe(((e,t,a,o,n,i)=>{const r=T("OrderTabPane"),s=T("UITabs");return h(),x("div",ke,[k(s,{animated:!1,activeKey:e.activeKey,onChange:e.changeTab},{default:xe((()=>[(h(!0),x(C,null,w(e.orderMap,(e=>(h(),x(r,{key:e.key,status:e.key},{tab:xe((()=>[k("b",null,S(e.title),1)])),_:2},1032,["status"])))),128))])),_:1},8,["activeKey","onChange"])])}));he.render=Ce,he.__scopeId="data-v-f83f3c9e";export default he;
